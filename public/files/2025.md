# 1 äº¬ä¸œé›¶å”® 20250326 ä¸€é¢

1. ç™»å½•ä¹‹åï¼Œurl è®¿é—®æ— æƒé™é¡µé¢ï¼Œå¦‚ä½•å¤„ç†ï¼Ÿ

   - api è¯·æ±‚æƒé™ï¼Œapi è¿”å›ä¹‹å‰ï¼Œå¤„äº loading çŠ¶æ€
   - api è¿”å›ä¹‹åï¼Œè·³è½¬åˆ° 404 é¡µé¢

2. éšæœºæ‰“ä¹±æ•°ç»„å…ƒç´ ï¼Ÿ

3. æ€ä¹ˆæé«˜æ¸²æŸ“æ•ˆç‡ï¼Ÿ

4. å¤§é‡è¿ç®—ï¼Œjs å¡ uiï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ

5. HTTP 2.0 ç‰¹æ€§ï¼Ÿ

6. http 301 302ï¼Ÿ

7. æŒ‡å¯¼æ–°äººï¼Œè§„èŒƒé£æ ¼ç»Ÿä¸€ï¼Ÿ

   - æ’ä»¶åŒæ­¥ï¼šå·¥ä½œåŒº extensions.json é…ç½®

8. æˆ‘çš„å‹ç¼©ç®—æ³•å®ç°åŸç†

9. npmã€pnpmã€yarn åŒºåˆ«ï¼Ÿ

10. css å±…ä¸­ï¼Ÿ

11. css åŠ¨ç”»å®ç° loading æ•ˆæœï¼Ÿ

# 2 è´å£³æ‰¾æˆ¿ 20250331 ä¸€é¢

1. æ€§èƒ½ä¼˜åŒ–

   - åŠ è½½æ€§èƒ½

     - FCPï¼ˆFirst Contentful Paintï¼‰ï¼šé¦–ä¸ªå†…å®¹ç»˜åˆ¶æ—¶é—´ï¼Œé¡µé¢é¦–æ¬¡æœ‰å†…å®¹æ¸²æŸ“çš„æ—¶é—´
     - LCPï¼ˆLargest Contentful Paintï¼‰ï¼šæœ€å¤§å†…å®¹ç»˜åˆ¶æ—¶é—´ï¼Œé¡µé¢ä¸­æœ€å¤§å¯è§†å†…å®¹æ¸²æŸ“å®Œæˆçš„æ—¶é—´ï¼Œç†æƒ³å€¼ < 2.5 ç§’
     - TTFBï¼ˆTime to First Byteï¼‰ï¼šé¦–å­—èŠ‚åˆ°è¾¾æ—¶é—´ï¼Œè¡¡é‡æœåŠ¡ç«¯å“åº”é€Ÿåº¦
     - FPï¼ˆFirst Paintï¼‰ï¼šé¦–æ¬¡ç»˜åˆ¶æ—¶é—´ï¼Œæµè§ˆå™¨å¼€å§‹ç»˜åˆ¶åƒç´ çš„æ—¶é—´

   - äº¤äº’æ€§èƒ½

     - FIDï¼ˆFirst Input Delayï¼‰ï¼šé¦–æ¬¡è¾“å…¥å»¶è¿Ÿï¼Œè¡¡é‡ç”¨æˆ·é¦–æ¬¡äº¤äº’çš„å“åº”æ—¶é—´ï¼Œç†æƒ³å€¼ < 100 æ¯«ç§’
     - INPï¼ˆInteraction to Next Paintï¼‰ï¼šäº¤äº’åˆ°ä¸‹ä¸€æ¬¡ç»˜åˆ¶çš„å»¶è¿Ÿï¼Œè¡¡é‡ç”¨æˆ·æ“ä½œåçš„å“åº”é€Ÿåº¦

   - é¡µé¢ç¨³å®šæ€§

     - CLSï¼ˆCumulative Layout Shiftï¼‰ï¼šç´¯ç§¯å¸ƒå±€åç§»é‡ï¼Œè¡¡é‡è§†è§‰ç¨³å®šæ€§ï¼Œç†æƒ³å€¼ < 0.1

   - ç½‘ç»œæ€§èƒ½

     - DNS Lookup Timeï¼šDNS è§£ææ—¶é—´
     - TCP Connect Timeï¼šTCP è¿æ¥æ—¶é—´
     - TLS Handshake Timeï¼šTLS æ¡æ‰‹æ—¶é—´
     - Resource Load Timeï¼šèµ„æºåŠ è½½æ—¶é—´

   - æ¸²æŸ“æ€§èƒ½
     - FPSï¼ˆFrames Per Secondï¼‰ï¼šæ¯ç§’å¸§æ•°ï¼Œç†æƒ³ä¿æŒåœ¨ 60 FPS
     - Layout Timeï¼šé¡µé¢å¸ƒå±€è®¡ç®—æ—¶é—´
     - Paint Timeï¼šé¡µé¢ç»˜åˆ¶æ—¶é—´
     - Compositing Timeï¼šåˆæˆå±‚çš„æ—¶é—´

2. createPortal

- ReactDOM.createPortal ç”¨äºå°†å­ç»„ä»¶æ¸²æŸ“åˆ°æŒ‡å®šçš„ DOM èŠ‚ç‚¹ä¹‹å¤–ã€‚
- ä½œç”¨ï¼šå¸¸ç”¨äºæ¨¡æ€æ¡†ã€å¼¹çª—ç­‰éœ€è¦åœ¨çˆ¶ç»„ä»¶ä¹‹å¤–æ¸²æŸ“çš„åœºæ™¯ã€‚

```jsx
import React from "react";
import ReactDOM from "react-dom";

function Modal({ children }) {
  return ReactDOM.createPortal(
    <div className="modal">{children}</div>,
    document.getElementById("modal-root")
  );
}
```

3. å†™ä¸€ä¸ª new Layout("å°æ˜").eat("æ°´æœ").sleep(5).eat("æ°´") ç±»æˆ–è€…å‡½æ•°ï¼Œèƒ½å¤Ÿé“¾å¼è°ƒç”¨ã€‚

```js
class Layout {
  constructor(name) {
    this.name = name;
    this.queue = [];
    console.log(`${this.name} åˆ›å»ºäº† Layout`);
    setTimeout(() => this.runQueue(), 0);
  }

  eat(food) {
    this.queue.push(() => console.log(`${this.name} æ­£åœ¨åƒ ${food}`));
    return this;
  }

  sleep(seconds) {
    this.queue.push(() => {
      console.log(`${this.name} å¼€å§‹ç¡è§‰ ${seconds} ç§’`);
      const start = Date.now();
      while (Date.now() - start < seconds * 1000) {}
      console.log(`${this.name} ç¡é†’äº†`);
    });
    return this;
  }

  runQueue() {
    if (this.queue.length > 0) {
      const task = this.queue.shift();
      task();
      setTimeout(() => this.runQueue(), 0);
    }
  }
}

// ä½¿ç”¨ç¤ºä¾‹
new Layout("å°æ˜").eat("æ°´æœ").sleep(5).eat("æ°´");
```

4. å†™ä¸€ä¸ª Promise.all

```js
function PromiseAll(promises) {
  return new Promise((resolve, reject) => {
    const results = [];
    let completedCount = 0; // è®°å½•å·²å®Œæˆçš„ Promise æ•°é‡
    promises.forEach((promise, index) => {
      Promise.resolve(promise)
        .then((value) => {
          results[index] = value;
          completedCount++;
          if (completedCount === promises.length) {
            resolve(results);
          }
        })
        .catch((reason) => {
          reject(reason); // åªè¦æœ‰ä¸€ä¸ª Promise å¤±è´¥ï¼Œç›´æ¥ reject
        });
    });
  });
}
```

# 3 å­¦å ‚åœ¨çº¿ 20250415 ç¬”è¯•ã€ä¸€é¢ã€äºŒé¢

1ã€js æ•°ç»„æœ‰å“ªäº›æ–¹æ³•ï¼›
2ã€ç¼–ç¨‹ï¼šå®ç°ä»»æ„è§’åº¦çš„æ‰‡å½¢ï¼›
3ã€ç¼–ç¨‹ï¼šå®ç°ç®€å•çš„å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼›
4ã€ç¼–ç¨‹ï¼šå®ç°ç®€å•çš„ promiseï¼›
5ã€ç¼–ç¨‹ï¼šå®ç°ä¸€ä¸ªè¿‡æ»¤æ¡†ï¼Œä¸‹æ–¹å±•ç¤ºè¿‡æ»¤åçš„åˆ—è¡¨ï¼›
6ã€proxy ç†è§£ï¼›
7ã€vue æŒ‰é’®æƒé™æ§åˆ¶ï¼›
8ã€http å¸¸è§çŠ¶æ€ç ã€è¯·æ±‚æ–¹æ³•ã€å«ä¹‰ï¼›
9ã€æµè§ˆå™¨ç¼“å­˜ï¼›

# 4 å…ƒä¿é›†å›¢ 20250421 ä¸€é¢

# 5 äº¬ä¸œ 20250421 ä¸€é¢

# 6 ç™¾åº¦ 20250421 ä¸€é¢

# 7 ç¾å›¢ 20250421 ä¸€é¢

# 8 å¹¶é›†ç§‘æŠ€ 20250423 ä¸€é¢

# 9 å…ƒä¿é›†å›¢ 20250425 äºŒé¢

# 10 ç™¾åº¦æ— äººè½¦ 20250428 ä¸€é¢

# 11 ç™¾åº¦æ— äººè½¦ 20250429 äºŒé¢

# 12 ç™¾åº¦æ— äººè½¦ 20250507 ä¸‰é¢

# 13 ç™¾åº¦æ— äººè½¦ 20250508 å››é¢

# 14 ç™¾åº¦åœ¨çº¿ 20250610 ä¸€é¢

# 15 ç™¾åº¦åœ¨çº¿ 20250616 äºŒé¢

# 16 å¿«æ‰‹ 20250619 ä¸€é¢

# 17 ç™¾åº¦åœ¨çº¿ 20250624 ä¸‰é¢

# 18 ç™¾åº¦æ–‡åº“ 20250627 ä¸€é¢

# 19 ç™¾åº¦æ–‡åº“ 20250701 äºŒé¢

# 20 é¡ºä¸° 20250715 ä¸€é¢

# 21 ç™¾åº¦åœ¨çº¿ 20250724 ä¸€é¢

# 22 ç¾å›¢æ—…å±… 20250731 ä¸€é¢

**é¢„æµ‹çš„é¢˜ç›®**

1ã€è¯·è§£é‡Šé—­åŒ…çš„åŸç†åŠå®é™…åº”ç”¨åœºæ™¯ï¼Œç»“åˆä½ çš„é¡¹ç›®ä¸¾ä¾‹è¯´æ˜ï¼ˆæ¯”å¦‚ç»„ä»¶å°è£…æˆ–å·¥å…·å‡½æ•°ä¸­æ˜¯å¦ç”¨åˆ°ï¼‰
é—­åŒ…æ˜¯æŒ‡å‡½æ•°åŠå…¶æ†ç»‘çš„å‘¨è¾¹çŠ¶æ€ï¼ˆè¯æ³•ç¯å¢ƒï¼‰çš„å¼•ç”¨çš„ç»„åˆï¼Œå…¶æ ¸å¿ƒåŸç†æ˜¯å‡½æ•°åœ¨å®šä¹‰æ—¶å¯ä»¥è®¿é—®å¤–å±‚å‡½æ•°çš„å˜é‡ï¼Œä¸”å½“å¤–å±‚å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œå†…å±‚å‡½æ•°ä»èƒ½è®¿é—®è¿™äº›å˜é‡ã€‚  
å®é™…åº”ç”¨åœºæ™¯åŒ…æ‹¬ï¼šå°è£…ç§æœ‰å˜é‡ã€å®ç°æ¨¡å—åŒ–å·¥å…·å‡½æ•°ç­‰ã€‚åœ¨å¼€å‘`jsonstring-pack`å·¥å…·æ—¶ï¼Œæˆ‘åˆ©ç”¨é—­åŒ…å°è£…äº† JSON å‹ç¼©çš„æ ¸å¿ƒé€»è¾‘ï¼Œå°†é€’å½’å¤„ç†å¤šå±‚åµŒå¥—ç»“æ„çš„æ–¹æ³•ä¸ä¸´æ—¶ç¼“å­˜å˜é‡ï¼ˆå¦‚å‹ç¼©æ˜ å°„è¡¨ï¼‰ç»‘å®šï¼Œé¿å…äº†å…¨å±€å˜é‡æ±¡æŸ“ï¼ŒåŒæ—¶ä¿è¯äº†å‹ç¼©è¿‡ç¨‹ä¸­æ•°æ®å¤„ç†çš„è¿ç»­æ€§ã€‚

2ã€æ‰‹å†™ Promise.allSettled å®ç°ï¼Œéœ€è¦å¤„ç†å¼‚æ­¥ä»»åŠ¡çš„æ‰€æœ‰ç»“æœï¼ˆæˆåŠŸ / å¤±è´¥ï¼‰

```javascript
Promise.myAllSettled = function (promises) {
  return new Promise((resolve) => {
    if (!Array.isArray(promises)) {
      return resolve([
        { status: "rejected", reason: new TypeError("å‚æ•°å¿…é¡»æ˜¯æ•°ç»„") },
      ]);
    }
    const result = [];
    let count = 0;
    promises.forEach((p, index) => {
      Promise.resolve(p).then(
        (value) => {
          result[index] = { status: "fulfilled", value };
          count++;
          if (count === promises.length) resolve(result);
        },
        (reason) => {
          result[index] = { status: "rejected", reason };
          count++;
          if (count === promises.length) resolve(result);
        }
      );
    });
  });
};
```

3ã€å¦‚ä½•å®ç°ä¸€ä¸ªå¸¦å¹¶å‘é™åˆ¶çš„å¼‚æ­¥è°ƒåº¦å™¨ï¼Ÿä¾‹å¦‚é™åˆ¶åŒæ—¶è¿è¡Œçš„ Promise æ•°é‡ä¸º 3

```js
class Scheduler {
  constructor(limit) {
    this.limit = limit;
    this.running = 0;
    this.queue = [];
  }

  add(promiseCreator) {
    return new Promise((resolve) => {
      this.queue.push({ promiseCreator, resolve });
      this.run();
    });
  }

  run() {
    if (this.running >= this.limit || this.queue.length === 0) return;
    this.running++;
    const { promiseCreator, resolve } = this.queue.shift();
    promiseCreator()
      .then((result) => {
        resolve(result);
        this.running--;
        this.run();
      })
      .catch((err) => {
        resolve(err); // æ•è·é”™è¯¯ï¼Œä¿è¯è°ƒåº¦ç»§ç»­
        this.running--;
        this.run();
      });
  }
}
```

4ã€è§£é‡ŠåŸå‹é“¾ä¸ç»§æ‰¿ï¼Œæ‰‹å†™ä¸€ä¸ªåŸºäº class çš„ç»§æ‰¿æ¡ˆä¾‹ï¼ˆç»“åˆä½ ç”¨ React å‡½æ•°ç»„ä»¶çš„ç»éªŒï¼Œå¯¹æ¯” class ç»„ä»¶çš„ç»§æ‰¿é€»è¾‘ï¼‰ã€‚
åŸå‹é“¾æ˜¯ JavaScript ä¸­å®ç°ç»§æ‰¿çš„åŸºç¡€ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰\_\_proto\_\_å±æ€§æŒ‡å‘å…¶åŸå‹å¯¹è±¡ï¼ŒåŸå‹å¯¹è±¡çš„\_\_proto\_\_åˆæŒ‡å‘æ›´ä¸Šå±‚åŸå‹ï¼Œæœ€ç»ˆæŒ‡å‘ nullï¼Œå½¢æˆé“¾å¼ç»“æ„ã€‚

åŸºäº class çš„ç»§æ‰¿æ¡ˆä¾‹ï¼š

```js
// çˆ¶ç±»ï¼šåŸºç¡€ç»„ä»¶
class BaseComponent {
  constructor(name) {
    this.name = name;
  }
  logName() {
    console.log(`Component name: ${this.name}`);
  }
}

// å­ç±»ï¼šè¡¨å•ç»„ä»¶ï¼ˆç»§æ‰¿åŸºç¡€ç»„ä»¶ï¼‰
class FormComponent extends BaseComponent {
  constructor(name, fields) {
    super(name);
    this.fields = fields;
  }
  renderFields() {
    console.log(`Rendering fields: ${this.fields.join(",")}`);
  }
}

// Reactåœºæ™¯å¯¹æ¯”ï¼šç±»ç»„ä»¶ä¾èµ–ç»§æ‰¿ï¼Œå‡½æ•°ç»„ä»¶é€šè¿‡ç»„åˆï¼ˆHooksï¼‰å¤ç”¨é€»è¾‘
// ç±»ç»„ä»¶å¯èƒ½é€šè¿‡extends React.Componentå®ç°ç»§æ‰¿ï¼Œè€Œå‡½æ•°ç»„ä»¶ç”¨useStateç­‰Hooksæ‹†åˆ†é€»è¾‘ï¼Œæ›´çµæ´»
```

5ã€æ‰‹å†™æ•°ç»„å»é‡ï¼ˆè€ƒè™‘å¯¹è±¡ã€NaN ç­‰ç‰¹æ®Šæƒ…å†µï¼‰ï¼Œå¹¶ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦ã€‚

```js
function uniqueArray(arr) {
  const map = new Map();
  return arr.filter((item) => {
    // å¤„ç†NaNï¼ˆMapä¸­NaNè§†ä¸ºç›¸ç­‰ï¼‰
    if (Number.isNaN(item)) {
      if (!map.has("NaN")) {
        map.set("NaN", true);
        return true;
      }
      return false;
    }
    // å¤„ç†å¯¹è±¡ï¼ˆåŸºäºå¼•ç”¨ï¼‰
    if (typeof item === "object" && item !== null) {
      const key = JSON.stringify(item); // ç®€å•å¯¹è±¡å¯ç”¨ï¼Œå¤æ‚å¯¹è±¡éœ€ä¼˜åŒ–
      if (!map.has(key)) {
        map.set(key, true);
        return true;
      }
      return false;
    }
    // åŸºæœ¬ç±»å‹
    if (!map.has(item)) {
      map.set(item, true);
      return true;
    }
    return false;
  });
}
// æ—¶é—´å¤æ‚åº¦O(n)ï¼Œç©ºé—´å¤æ‚åº¦O(n)ï¼Œé€šè¿‡Mapå®ç°ä¸€æ¬¡éå†å»é‡
```

6ã€å®ç°ä¸€ä¸ª LRU ç¼“å­˜æœºåˆ¶ï¼ˆç»“åˆä½  â€œå¤§å‹è¡¨æ ¼ç¼“å­˜å­—æ®µæ•°æ®â€ çš„ç»éªŒï¼‰ã€‚

ç»“åˆå¤§å‹è¡¨æ ¼ç¼“å­˜å­—æ®µæ•°æ®çš„ç»éªŒï¼ŒLRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ç¼“å­˜æ ¸å¿ƒæ˜¯æ·˜æ±°æœ€ä¹…æœªä½¿ç”¨çš„æ•°æ®ï¼š

```js
class LRUCache {
  constructor(capacity) {
    this.capacity = capacity;
    this.cache = new Map(); // åˆ©ç”¨Mapçš„æ’å…¥é¡ºåºç‰¹æ€§
  }

  get(key) {
    if (!this.cache.has(key)) return -1;
    const value = this.cache.get(key);
    // è®¿é—®åç§»åˆ°æœ€æ–°ä½ç½®
    this.cache.delete(key);
    this.cache.set(key, value);
    return value;
  }

  put(key, value) {
    if (this.cache.has(key)) {
      this.cache.delete(key); // å·²å­˜åœ¨åˆ™å…ˆåˆ é™¤
    } else if (this.cache.size >= this.capacity) {
      // è¶…è¿‡å®¹é‡ï¼Œåˆ é™¤æœ€æ—§çš„ï¼ˆMapçš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰
      const oldestKey = this.cache.keys().next().value;
      this.cache.delete(oldestKey);
    }
    this.cache.set(key, value); // æ’å…¥æ–°å€¼ï¼ˆæœ€æ–°ä½ç½®ï¼‰
  }
}
// åœ¨è±ç”µTBOXè½¦è”ç½‘å¹³å°çš„å¤§å‹è¡¨æ ¼ä¸­ï¼Œç±»ä¼¼é€»è¾‘ç”¨äºç¼“å­˜é«˜é¢‘è®¿é—®çš„å­—æ®µæ•°æ®ï¼Œå‡å°‘é‡å¤æ¸²æŸ“è®¡ç®—
```

7ã€å¦‚ä½•æ£€æµ‹å¹¶ä¿®å¤å‰ç«¯ä»£ç ä¸­çš„å†…å­˜æ³„æ¼ï¼Ÿä¸¾ä¾‹è¯´æ˜ä½ é‡åˆ°è¿‡çš„åœºæ™¯ï¼ˆæ¯”å¦‚ Electron è·¨ç«¯é¡¹ç›®ä¸­æ˜¯å¦æœ‰ç±»ä¼¼é—®é¢˜ï¼‰ã€‚

å†…å­˜æ³„æ¼å¸¸è§åœºæ™¯ï¼šæœªæ¸…ç†çš„äº‹ä»¶ç›‘å¬ã€é—­åŒ…ä¸­å¼•ç”¨çš„ DOM æœªé‡Šæ”¾ã€å®šæ—¶å™¨æœªæ¸…é™¤ç­‰ã€‚
åœ¨ Electron é¡¹ç›®ä¸­ï¼Œæ›¾é‡åˆ°è¿‡ ipc é€šä¿¡çš„å›è°ƒå‡½æ•°æœªæ­£ç¡®è§£ç»‘å¯¼è‡´çš„æ³„æ¼ï¼šå½“çª—å£å…³é—­åï¼ŒipcRenderer.on æ³¨å†Œçš„ç›‘å¬ä»è¢«å¼•ç”¨ï¼Œå¯¼è‡´çª—å£å®ä¾‹æ— æ³•è¢« GC å›æ”¶ã€‚
è§£å†³æ–¹å¼ï¼šåœ¨ç»„ä»¶å¸è½½æˆ–çª—å£å…³é—­æ—¶ï¼Œé€šè¿‡ ipcRenderer.removeListener æ‰‹åŠ¨ç§»é™¤ç›‘å¬ï¼›å¯¹é•¿æœŸå­˜åœ¨çš„ websocket è¿æ¥ï¼Œåœ¨æ–­å¼€æ—¶æ¸…é™¤æ‰€æœ‰å›è°ƒå‡½æ•°ï¼Œé¿å…å¼•ç”¨æ®‹ç•™ã€‚

8ã€è§£é‡Š React çš„è™šæ‹Ÿ DOM ä¸ Diff ç®—æ³•åŸç†ï¼Œä½ åœ¨ â€œ10 + ä¸‡è¡Œå¤§å‹è¡¨æ ¼â€ ä¸­æ˜¯å¦‚ä½•é€šè¿‡è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–æ€§èƒ½çš„ï¼Ÿå…·ä½“å®ç°é€»è¾‘æ˜¯ä»€ä¹ˆï¼Ÿ

è™šæ‹Ÿ DOMï¼šæ˜¯ React å¯¹çœŸå® DOM çš„å†…å­˜æ˜ å°„ï¼Œé€šè¿‡ JS å¯¹è±¡æè¿° DOM ç»“æ„ï¼Œé¿å…é¢‘ç¹æ“ä½œçœŸå® DOM çš„æ€§èƒ½å¼€é”€ã€‚
Diff ç®—æ³•ï¼šReact é‡‡ç”¨åˆ†å±‚æ¯”è¾ƒï¼ˆåŒå±‚èŠ‚ç‚¹å¯¹æ¯”ï¼‰ã€åˆ—è¡¨èŠ‚ç‚¹ç”¨ key æ ‡è¯†é¿å…å…¨é‡å¯¹æ¯”ï¼Œé™ä½å¤æ‚åº¦ã€‚
åœ¨ 10 + ä¸‡è¡Œå¤§å‹è¡¨æ ¼ä¼˜åŒ–ä¸­ï¼Œè™šæ‹Ÿæ»šåŠ¨çš„å®ç°é€»è¾‘ï¼š
è®¡ç®—å¯è§†åŒºåŸŸé«˜åº¦ä¸æ¯è¡Œé«˜åº¦ï¼Œç¡®å®šå¯è§†èŒƒå›´å†…çš„è¡Œç´¢å¼•ï¼ˆå¦‚æ»šåŠ¨åˆ°ç¬¬ 500 è¡Œï¼Œå¯è§†åŒºæ˜¾ç¤º 500-600 è¡Œï¼‰ï¼›
åªæ¸²æŸ“å¯è§†åŒºçš„è¡Œ DOMï¼Œéå¯è§†åŒºç”¨ç©ºç™½ div å ä½ï¼ˆæ’‘å¼€æ»šåŠ¨é«˜åº¦ï¼‰ï¼›
ç›‘å¬æ»šåŠ¨äº‹ä»¶ï¼ŒåŠ¨æ€æ›´æ–°å¯è§†åŒºè¡Œç´¢å¼•å¹¶é‡æ–°æ¸²æŸ“å¯¹åº”è¡Œï¼ŒåŒæ—¶å¤ç”¨å·²åˆ›å»ºçš„ DOM èŠ‚ç‚¹å‡å°‘åˆ›å»ºå¼€é”€ï¼›
ç»“åˆå­—æ®µæ•°æ®ç¼“å­˜ï¼Œé¿å…é‡å¤è®¡ç®—å•å…ƒæ ¼å†…å®¹ï¼Œè¿›ä¸€æ­¥å‡å°‘æ¸²æŸ“å‹åŠ›ã€‚

9ã€Hooks çš„è®¾è®¡åŸç†æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆå‡½æ•°ç»„ä»¶æ¯”ç±»ç»„ä»¶æ›´é€‚åˆé…åˆ Hooks ä½¿ç”¨ï¼Ÿä½ åœ¨ â€œå‰ç«¯å¼€å‘è§„èŒƒè®¾è®¡â€ ä¸­è¿ç§»ç±»ç»„ä»¶åˆ°å‡½æ•°ç»„ä»¶æ—¶é‡åˆ°è¿‡å“ªäº›å‘ï¼Ÿ

Hooks è®¾è®¡åŸç†ï¼šåŸºäºé—­åŒ…å’Œé“¾è¡¨å­˜å‚¨çŠ¶æ€ï¼Œå°†ç»„ä»¶çŠ¶æ€ä¸å‰¯ä½œç”¨ä»ç»„ä»¶ç”Ÿå‘½å‘¨æœŸä¸­æŠ½ç¦»ï¼Œå®ç°é€»è¾‘å¤ç”¨ã€‚æ¯æ¬¡æ¸²æŸ“æ—¶ï¼ŒHooks æŒ‰è°ƒç”¨é¡ºåºå…³è”å¯¹åº”çš„çŠ¶æ€ï¼Œå› æ­¤è¦æ±‚ Hooks ä¸èƒ½åœ¨æ¡ä»¶è¯­å¥ä¸­è°ƒç”¨ã€‚
å‡½æ•°ç»„ä»¶æ›´é€‚åˆ Hooksï¼šå‡½æ•°ç»„ä»¶æœ¬è´¨æ˜¯çº¯å‡½æ•°ï¼Œæ²¡æœ‰ this æŒ‡å‘é—®é¢˜ï¼ŒHooks çš„çŠ¶æ€ç®¡ç†é€»è¾‘ï¼ˆå¦‚ useStateï¼‰ä¸å‡½æ•°ç»„ä»¶çš„è°ƒç”¨ä¸Šä¸‹æ–‡å¤©ç„¶å¥‘åˆï¼›è€Œç±»ç»„ä»¶ä¾èµ– this.state å’Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œé€»è¾‘åˆ†æ•£ä¸”å¤ç”¨å›°éš¾ã€‚
è¿ç§»ç±»ç»„ä»¶åˆ°å‡½æ•°ç»„ä»¶æ—¶çš„å‘ï¼š
this æŒ‡å‘ä¸¢å¤±ï¼šç±»ç»„ä»¶ä¸­ this.handleClick = this.handleClick.bind(this)çš„é€»è¾‘éœ€æ”¹ä¸ºç®­å¤´å‡½æ•°æˆ–ç›´æ¥åœ¨ Hooks ä¸­å®šä¹‰ï¼›
ç”Ÿå‘½å‘¨æœŸæ˜ å°„é—®é¢˜ï¼šcomponentDidMount ä¸ componentDidUpdate åˆå¹¶ä¸º useEffectï¼Œéœ€æ³¨æ„ä¾èµ–æ•°ç»„çš„è®¾ç½®ï¼Œé¿å…æ— é™å¾ªç¯ï¼›
çŠ¶æ€æ›´æ–°é€»è¾‘ï¼šç±»ç»„ä»¶çš„ setState æ˜¯åˆå¹¶æ›´æ–°ï¼Œè€Œ useState çš„æ›´æ–°å‡½æ•°æ˜¯æ›¿æ¢ï¼Œéœ€æ‰‹åŠ¨å¤„ç†å¯¹è±¡ç±»å‹çŠ¶æ€çš„åˆå¹¶ã€‚

10ã€å¦‚ä½•è®¾è®¡ä¸€ä¸ªå¯å¤ç”¨çš„è¡¨å•ç»„ä»¶ï¼ˆç»“åˆä½  â€œé…ç½®å‹è¡¨å•ç»„ä»¶â€ çš„ç»éªŒï¼‰ï¼Œéœ€è¦è€ƒè™‘å“ªäº›æ‰©å±•æ€§å’Œæ€§èƒ½é—®é¢˜ï¼Ÿ

ç»“åˆ WFUZZ é¡¹ç›®çš„é…ç½®å‹è¡¨å•ç»„ä»¶ç»éªŒï¼Œè®¾è®¡æ€è·¯ï¼š
åŸºäº JSON Schema é©±åŠ¨ï¼šé€šè¿‡è½¬æ¢å·¥å…·è¯»å– JSON é…ç½®ï¼ˆåŒ…å«å­—æ®µç±»å‹ã€æ ¡éªŒè§„åˆ™ã€UI å±æ€§ç­‰ï¼‰ï¼Œè‡ªåŠ¨ç”Ÿæˆè¡¨å•é¡¹ï¼›
ç»„ä»¶åˆ†å±‚è®¾è®¡ï¼šæ‹†åˆ†ä¸º Formï¼ˆå®¹å™¨ï¼‰ã€FormItemï¼ˆå•é¡¹åŒ…è£…ï¼‰ã€FormControlï¼ˆè¾“å…¥æ§ä»¶ï¼Œå¦‚ Input/Selectï¼‰ï¼Œé€šè¿‡ Context ä¼ é€’è¡¨å•çŠ¶æ€ï¼›
æ‰©å±•æ€§è€ƒè™‘ï¼šæ”¯æŒè‡ªå®šä¹‰æ§ä»¶æ³¨å†Œï¼ˆå¦‚ç‰¹æ®Šæ—¥æœŸé€‰æ‹©å™¨ï¼‰ã€åŠ¨æ€å¢å‡è¡¨å•é¡¹ã€åµŒå¥—è¡¨å•ï¼ˆé€šè¿‡é€’å½’è§£æ JSONï¼‰ï¼›
æ€§èƒ½ä¼˜åŒ–ï¼šä½¿ç”¨ useMemo ç¼“å­˜ç”Ÿæˆçš„è¡¨å•é¡¹é…ç½®ï¼ŒuseCallback ç¼“å­˜ onChange å›è°ƒï¼Œé¿å…å› çˆ¶ç»„ä»¶é‡æ¸²æŸ“å¯¼è‡´çš„ä¸å¿…è¦æ›´æ–°ã€‚

11ã€åœ¨è·¨ç«¯é¡¹ç›®ï¼ˆå¦‚ä½ çš„ Electron åº”ç”¨ï¼‰ä¸­ï¼Œå¦‚ä½•å¤„ç†å‰ç«¯ä¸åç«¯ / å…¶ä»–ç«¯çš„çŠ¶æ€åŒæ­¥ï¼Ÿä½ ç”¨ â€œé¢„å®šä¹‰å¯¹è±¡ç»“æ„ + websocket æ›´æ–°â€ çš„æ–¹æ¡ˆç›¸æ¯”ä¼ ç»ŸçŠ¶æ€ç®¡ç†ï¼ˆå¦‚ Reduxï¼‰æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ

åœ¨ Electron é¡¹ç›®ä¸­ï¼Œå‰ç«¯ä¸ rust å·¥å…·ç«¯çš„çŠ¶æ€åŒæ­¥æ–¹æ¡ˆï¼š
é¢„å®šä¹‰åŒæ–¹ä¸€è‡´çš„æ•°æ®ç»“æ„ï¼ˆå¦‚{ id: string, status: string, config: object }ï¼‰ï¼›
é€šè¿‡ websocket å®æ—¶å‘é€çŠ¶æ€æ›´æ–°æ“ä½œï¼ˆå¦‚{ type: 'update', path: 'status', value: 'running' }ï¼‰ï¼›
å‰ç«¯ç»´æŠ¤æœ¬åœ°çŠ¶æ€å¯¹è±¡ï¼Œæ¥æ”¶æ›´æ–°æ“ä½œåé€šè¿‡è·¯å¾„ï¼ˆå¦‚ statusï¼‰å®šä½å¹¶ä¿®æ”¹å¯¹åº”å­—æ®µï¼Œä¿è¯ä¸¤ç«¯çŠ¶æ€ä¸€è‡´ã€‚
ç›¸æ¯” Redux çš„ä¼˜åŠ¿ï¼š
è½»é‡æ€§ï¼šæ— éœ€å¼•å…¥å¤æ‚çš„ action/reducer æœºåˆ¶ï¼Œé€‚åˆè·¨ç«¯é—´çš„ç®€å•çŠ¶æ€åŒæ­¥ï¼›
å®æ—¶æ€§ï¼šåŸºäº websocket çš„æ¨é€æ¨¡å¼ï¼Œæ¯” Redux çš„å•å‘æ•°æ®æµæ›´é«˜æ•ˆï¼›
é’ˆå¯¹æ€§ï¼šä¸ºè·¨ç«¯åœºæ™¯è®¾è®¡ï¼Œé¿å… Redux ä¸­å…¨å±€çŠ¶æ€æ ‘å¯èƒ½å¯¼è‡´çš„å†—ä½™ã€‚

12ã€è§£é‡Š React Context çš„ä½¿ç”¨åœºæ™¯åŠæ€§èƒ½ç“¶é¢ˆï¼Œä½ åœ¨é¡¹ç›®ä¸­æ˜¯å¦ç”¨è¿‡ï¼Ÿå¦‚æœç”¨ï¼Œå¦‚ä½•é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“ï¼Ÿ

ä½¿ç”¨åœºæ™¯ï¼šé€‚åˆå…¨å±€å…±äº«å°‘é‡ç¨³å®šæ•°æ®ï¼ˆå¦‚ä¸»é¢˜é…ç½®ã€ç”¨æˆ·ä¿¡æ¯ï¼‰ï¼Œé¿å… props å¤šå±‚ä¼ é€’ï¼ˆâ€œprops drillingâ€ï¼‰ã€‚
æ€§èƒ½ç“¶é¢ˆï¼šå½“ Context çš„å€¼å˜åŒ–æ—¶ï¼Œæ‰€æœ‰æ¶ˆè´¹è¯¥ Context çš„ç»„ä»¶éƒ½ä¼šé‡æ¸²æŸ“ï¼Œå³æŸ“ï¼Œå³ä½¿åªç”¨åˆ° Context ä¸­çš„éƒ¨åˆ†æ•°æ®ã€‚
é¡¹ç›®ä¸­æœªç›´æ¥ä½¿ç”¨ Contextï¼Œä¸»è¦å› å¤§å‹è¡¨æ ¼å’Œè·¨ç«¯é¡¹ç›®å¯¹æ€§èƒ½æ•æ„Ÿï¼Œæ›´å€¾å‘äºé€šè¿‡ç»„ä»¶ç»„åˆæˆ–çŠ¶æ€ç®¡ç†åº“ï¼ˆå¦‚å±€éƒ¨çŠ¶æ€ + è‡ªå®šä¹‰ hooksï¼‰æ‹†åˆ†çŠ¶æ€ï¼Œå‡å°‘ä¸å¿…è¦çš„é‡æ¸²æŸ“ã€‚è‹¥ä½¿ç”¨ Contextï¼Œä¼šé€šè¿‡ â€œæ‹†åˆ†å¤šä¸ª Contextâ€ï¼ˆå¦‚å°†ä¸»é¢˜å’Œç”¨æˆ·ä¿¡æ¯åˆ†ä¸ºä¸¤ä¸ª Contextï¼‰ã€ç»“åˆ useMemo ç¼“å­˜ Context å€¼ç­‰æ–¹å¼ä¼˜åŒ–ã€‚

13ã€è¯¦ç»†è¯´æ˜ä½ åœ¨ â€œåè®®æ¨¡ç³Šæµ‹è¯•ç³»ç»Ÿâ€ ä¸­æ˜¯å¦‚ä½•ä¼˜åŒ– Webpack é…ç½®çš„ï¼Ÿå¤šçº¿ç¨‹å¤„ç†å…·ä½“ç”¨äº†å“ªäº› loader æˆ–æ’ä»¶ï¼Ÿæ„å»ºé€Ÿåº¦æå‡äº†å¤šå°‘ï¼Ÿ

ä¼˜åŒ–æªæ–½ï¼š
ç®€åŒ– loader è®¾ç½®ï¼šä»…å¯¹å¿…è¦æ–‡ä»¶ï¼ˆå¦‚ jsxã€tsï¼‰å¯ç”¨ babel-loaderï¼Œæ’é™¤ node_modules ç›®å½•ï¼›
å¤šçº¿ç¨‹å¹¶è¡Œå¤„ç†ï¼šä½¿ç”¨ thread-loader é…åˆ babel-loaderï¼Œå°† JS ç¼–è¯‘ä»»åŠ¡åˆ†é…åˆ°å¤šçº¿ç¨‹æ‰§è¡Œï¼Œé…ç½®å¦‚ä¸‹ï¼š

```js
module: {
  rules: [
    {
      test: /\.jsx?$/,
      use: [
        "thread-loader", // å¤šçº¿ç¨‹å¤„ç†
        "babel-loader",
      ],
      exclude: /node_modules/,
    },
  ];
}
```

å…¶ä»–ä¼˜åŒ–ï¼šå¯ç”¨ cache-loader ç¼“å­˜ç¼–è¯‘ç»“æœï¼Œåˆ†ç¦» runtimeChunk é¿å…å“ˆå¸Œå€¼é¢‘ç¹å˜åŒ–ã€‚
æ•ˆæœï¼šæ„å»ºæ—¶é—´å‡å°‘çº¦ 40%ï¼Œä»åŸæ¥çš„ 80 ç§’ç¼©çŸ­è‡³ 48 ç§’å·¦å³ã€‚

14ã€å¦‚ä½•è®¾è®¡å‰ç«¯å·¥ç¨‹åŒ–ä½“ç³»ï¼ˆç»“åˆä½  â€œjenkins é…ç½®â€â€œdocker éƒ¨ç½²â€ çš„ç»éªŒï¼‰ï¼ŸåŒ…æ‹¬ä»£ç è§„èŒƒï¼ˆeslint+pre-commitï¼‰ã€CI/CD æµç¨‹ã€ç¯å¢ƒéš”ç¦»ç­‰ã€‚

ç»“åˆé¡¹ç›®ç»éªŒï¼Œå·¥ç¨‹åŒ–ä½“ç³»åŒ…æ‹¬ï¼š
ä»£ç è§„èŒƒï¼š
ç»Ÿä¸€å¼€å‘æ–¹å¼ï¼šé‡‡ç”¨å‡½æ•°ç»„ä»¶ + TypeScriptï¼Œé€šè¿‡ ESLintï¼ˆé…ç½® eslint-config-react-appï¼‰å’Œ Prettier å¼ºåˆ¶ä»£ç é£æ ¼ï¼›
æäº¤è§„èŒƒï¼šä½¿ç”¨ husky çš„ pre-commit é’©å­ï¼Œé€šè¿‡ lint-staged å¯¹æš‚å­˜åŒºä»£ç æ‰§è¡Œ ESLint æ£€æŸ¥ï¼Œä¸é€šè¿‡åˆ™é˜»æ­¢æäº¤ã€‚
CI/CD æµç¨‹ï¼š
ç”¨ Jenkins åˆ›å»ºæµæ°´çº¿ï¼šæ‹‰å–ä»£ç  â†’ å®‰è£…ä¾èµ– â†’ æ‰§è¡Œæµ‹è¯• â†’ æ„å»ºæ‰“åŒ… â†’ æ¨é€ docker é•œåƒï¼›
å¤šç¯å¢ƒéƒ¨ç½²ï¼šé€šè¿‡ docker ç¯å¢ƒå˜é‡åŒºåˆ†å¼€å‘ / æµ‹è¯• / ç”Ÿäº§ç¯å¢ƒï¼ŒåŠ¨æ€æ³¨å…¥ API åœ°å€ç­‰é…ç½®ã€‚
ç¯å¢ƒéš”ç¦»ï¼šå¼€å‘ç¯å¢ƒç”¨ webpack-dev-server æœ¬åœ°ä»£ç†ï¼Œæµ‹è¯• / ç”Ÿäº§ç¯å¢ƒé€šè¿‡ docker å®¹å™¨éš”ç¦»ï¼Œé¿å…ä¾èµ–å†²çªã€‚

15ã€å¯¹æ¨¡å—åŒ–æ–¹æ¡ˆï¼ˆESMã€CommonJSï¼‰çš„ç†è§£ï¼Œåœ¨ Electron é¡¹ç›®ä¸­å¦‚ä½•å¤„ç†ä¸»è¿›ç¨‹ä¸æ¸²æŸ“è¿›ç¨‹çš„æ¨¡å—ä¾èµ–ï¼Ÿ

æ¨¡å—åŒ–æ–¹æ¡ˆï¼šESMï¼ˆES æ¨¡å—ï¼‰æ˜¯æµè§ˆå™¨åŸç”Ÿæ”¯æŒçš„æ¨¡å—åŒ–æ ‡å‡†ï¼Œé€šè¿‡ import/export å®ç°ï¼Œé™æ€åˆ†æï¼›CommonJS æ˜¯ Node.js çš„æ¨¡å—åŒ–æ–¹æ¡ˆï¼Œé€šè¿‡ require/module.exports å®ç°ï¼ŒåŠ¨æ€åŠ è½½ã€‚
Electron ä¸­ä¸»è¿›ç¨‹ä¸æ¸²æŸ“è¿›ç¨‹çš„ä¾èµ–å¤„ç†ï¼š
ä¸»è¿›ç¨‹ï¼ˆNode ç¯å¢ƒï¼‰ä½¿ç”¨ CommonJSï¼Œæ¸²æŸ“è¿›ç¨‹ï¼ˆæµè§ˆå™¨ç¯å¢ƒï¼‰ä½¿ç”¨ ESMï¼›
å…±äº«ä»£ç ï¼ˆå¦‚å·¥å…·å‡½æ•°ï¼‰é€šè¿‡ babel è½¬æ¢ä¸ºå…¼å®¹ä¸¤ç§æ¨¡å—çš„æ ¼å¼ï¼Œæˆ–ç”¨ rollup æ‰“åŒ…ä¸º UMD æ ¼å¼ï¼›
é¿å…åœ¨æ¸²æŸ“è¿›ç¨‹ä¸­ç›´æ¥å¼•ç”¨ Node æ¨¡å—ï¼Œé€šè¿‡ ipc é€šä¿¡è®©ä¸»è¿›ç¨‹å¤„ç† Node ç›¸å…³æ“ä½œï¼ˆå¦‚æ–‡ä»¶è¯»å†™ï¼‰ï¼Œä¿è¯æ¸²æŸ“è¿›ç¨‹çš„æµè§ˆå™¨å…¼å®¹æ€§ã€‚

16ã€ä½ ç”¨ Electron å¼€å‘æ¡Œé¢ç«¯æ—¶ï¼Œå¦‚ä½•è§£å†³ â€œelectron ä»£ç è¿ç§»åˆ°ç½‘ç«™å‰ç«¯â€ çš„å…¼å®¹æ€§é—®é¢˜ï¼Ÿï¼ˆç»“åˆç¯å¢ƒå˜é‡ã€ipc å‡½æ•°æ›¿ä»£æ–¹æ¡ˆç­‰ç»†èŠ‚ï¼‰

è¿ç§» electron ä»£ç åˆ°ç½‘ç«™å‰ç«¯æ—¶ï¼Œä¸»è¦è§£å†³ä»¥ä¸‹å…¼å®¹é—®é¢˜ï¼š
ç¯å¢ƒåŒºåˆ†ï¼šé€šè¿‡ process.env.NODE_ENVï¼ˆElectron ä¸­ï¼‰å’Œ window.\_\_IS_ELECTRON\_\_ï¼ˆç½‘ç«™ä¸­ï¼‰æ ‡è¯†ç¯å¢ƒï¼Œæ¡ä»¶æ¸²æŸ“æ ·å¼ï¼ˆå¦‚ Electron çš„çª—å£è¾¹æ¡†æ ·å¼åœ¨ç½‘ç«™ä¸­éšè—ï¼‰ï¼›
ipc æ›¿ä»£ï¼šç”¨å†—ä½™çš„ ipc å‡½æ•°æ¨¡æ‹Ÿ Electron çš„ ipcRendererï¼Œåœ¨ç½‘ç«™ç¯å¢ƒä¸­è¿™äº›å‡½æ•°ä¸ºç©ºå®ç°æˆ–è°ƒç”¨ websocket æ¥å£ï¼›
è·¯å¾„å¤„ç†ï¼šElectron çš„\_\_dirname åœ¨ç½‘ç«™ä¸­æ›¿æ¢ä¸º window.location.pathnameï¼Œé¿å…æ–‡ä»¶è·¯å¾„é”™è¯¯ï¼›
æ¨¡å—å…¼å®¹ï¼šç§»é™¤æ¸²æŸ“è¿›ç¨‹ä¸­å¯¹ fsã€path ç­‰ Node æ¨¡å—çš„ç›´æ¥å¼•ç”¨ï¼Œæ”¹ä¸ºè°ƒç”¨åç«¯ API è·å–æ–‡ä»¶æ•°æ®ã€‚

17ã€å¯¹æ¯” Electron ä¸å…¶ä»–è·¨ç«¯æ¡†æ¶ï¼ˆå¦‚ RNã€Taroï¼‰çš„æŠ€æœ¯å·®å¼‚ï¼Œå¦‚æœä½ éœ€è¦é€‚é…é¸¿è’™ç³»ç»Ÿï¼Œä¼šä»å“ªäº›æ–¹é¢å…¥æ‰‹ï¼Ÿï¼ˆå²—ä½ä¼˜å…ˆé¡¹ï¼‰

æŠ€æœ¯å·®å¼‚ï¼š
Electronï¼šåŸºäº Chromium+Node.jsï¼Œç”¨ Web æŠ€æœ¯å¼€å‘æ¡Œé¢ç«¯ï¼Œä¼˜åŠ¿æ˜¯ç”Ÿæ€æˆç†Ÿï¼ŒåŠ£åŠ¿æ˜¯åŒ…ä½“ç§¯å¤§ï¼›
RN/Taroï¼šé€šè¿‡ JS æ¡¥æ¥åŸç”Ÿç»„ä»¶ï¼Œé€‚åˆç§»åŠ¨ç«¯ï¼Œæ€§èƒ½æ¥è¿‘åŸç”Ÿï¼Œä½†éœ€ç»´æŠ¤å¤šç«¯é€‚é…é€»è¾‘ã€‚
é¸¿è’™é€‚é…æ€è·¯ï¼š
å…ˆç ”ç©¶é¸¿è’™ ArkUI æ¡†æ¶çš„ç»„ä»¶æ¨¡å‹å’ŒçŠ¶æ€ç®¡ç†æ–¹å¼ï¼Œå¯¹æ¯” React çš„å·®å¼‚ï¼›
å°è£…è·¨ç«¯ç»„ä»¶åº“ï¼šå°†å¸¸ç”¨ UI ç»„ä»¶ï¼ˆå¦‚æŒ‰é’®ã€è¡¨æ ¼ï¼‰æŠ½è±¡ä¸ºé€‚é…å±‚ï¼Œæ ¹æ®ç¯å¢ƒæ¸²æŸ“ ArkUI æˆ– React ç»„ä»¶ï¼›
é€šä¿¡å±‚é€‚é…ï¼šç”¨é¸¿è’™çš„@ohos.net.websocket æ›¿ä»£æµè§ˆå™¨ websocketï¼Œä¿è¯æ•°æ®äº¤äº’é€»è¾‘ä¸€è‡´ï¼›
é€æ­¥è¿ç§»ï¼šå…ˆé€‚é…æ ¸å¿ƒåŠŸèƒ½ï¼ˆå¦‚æ•°æ®å±•ç¤ºï¼‰ï¼Œå†ä¼˜åŒ–æ€§èƒ½å’ŒåŸç”Ÿç‰¹æ€§è°ƒç”¨ã€‚

18ã€è·¨ç«¯é¡¹ç›®ä¸­å¦‚ä½•ä¿è¯ä¸‰ç«¯ï¼ˆiOS/Android/ é¸¿è’™ï¼‰çš„ UI ä¸€è‡´æ€§å’Œæ€§èƒ½ï¼Ÿä½ è®¤ä¸ºæœ€å¤§çš„æŒ‘æˆ˜æ˜¯ä»€ä¹ˆï¼Ÿ

UI ä¸€è‡´æ€§ï¼š
åˆ¶å®šç»Ÿä¸€è®¾è®¡è§„èŒƒï¼šå®šä¹‰å­—å·ã€é¢œè‰²ã€é—´è·ç­‰åŸºç¡€æ ·å¼å˜é‡ï¼Œé€šè¿‡ CSS å˜é‡æˆ–ä¸»é¢˜æ–‡ä»¶å…±äº«ï¼›
ä½¿ç”¨è·¨ç«¯ UI åº“ï¼šå¦‚ ant-design-mobile é€‚é…å¤šç«¯ï¼Œæˆ–è‡ªå®šä¹‰ç»„ä»¶åº“ä¿è¯æ¸²æŸ“ä¸€è‡´æ€§ã€‚
æ€§èƒ½ä¿éšœï¼š
æŒ‰éœ€åŠ è½½ï¼šæ ¹æ®ç«¯ç±»å‹ï¼ˆå¦‚ iOS/Androidï¼‰åŠ è½½å¯¹åº”ä¼˜åŒ–çš„ç»„ä»¶ä»£ç ï¼›
åŸç”Ÿèƒ½åŠ›è°ƒç”¨ï¼šå¤æ‚åœºæ™¯ï¼ˆå¦‚å¤§æ•°æ®è¡¨æ ¼ï¼‰è°ƒç”¨ç«¯åŸç”Ÿ APIï¼Œé¿å…çº¯ JS å®ç°çš„æ€§èƒ½ç“¶é¢ˆã€‚
æœ€å¤§æŒ‘æˆ˜ï¼šä¸åŒå¹³å°çš„æ¸²æŸ“å¼•æ“å·®å¼‚ï¼ˆå¦‚é¸¿è’™çš„æ–¹èˆŸå¼•æ“ä¸æµè§ˆå™¨çš„ WebKitï¼‰ï¼Œå¯èƒ½å¯¼è‡´ç›¸åŒ CSS åœ¨ä¸åŒç«¯è¡¨ç°ä¸ä¸€è‡´ï¼Œéœ€è¦å¤§é‡é’ˆå¯¹æ€§è°ƒè¯•ã€‚

19ã€ä½ äº†è§£å“ªäº› AI è¾…åŠ©å‰ç«¯å¼€å‘çš„å·¥å…·æˆ–åœºæ™¯ï¼Ÿï¼ˆå¦‚ä»£ç ç”Ÿæˆã€è‡ªåŠ¨åŒ–æµ‹è¯•ã€æ€§èƒ½åˆ†æï¼‰å¦‚æœè¦åœ¨å›¢é˜Ÿä¸­è½åœ° AI Codingï¼Œä½ ä¼šä»å“ªä¸ªåœºæ™¯åˆ‡å…¥ï¼Ÿï¼ˆç»“åˆä½  â€œå¼€å‘æ•ˆç‡æå‡â€ çš„ç»éªŒï¼‰

äº†è§£çš„å·¥å…· / åœºæ™¯ï¼š
ä»£ç ç”Ÿæˆï¼šGitHub Copilot è‡ªåŠ¨ç”Ÿæˆå‡½æ•°æˆ–ç»„ä»¶ä»£ç ï¼›
è‡ªåŠ¨åŒ–æµ‹è¯•ï¼šAI å·¥å…·ï¼ˆå¦‚ Applitoolsï¼‰é€šè¿‡å›¾åƒè¯†åˆ«æ£€æµ‹ UI å›å½’ï¼›
æ€§èƒ½åˆ†æï¼šåŸºäº AI çš„ç›‘æ§å·¥å…·ï¼ˆå¦‚ Lighthouse AIï¼‰è‡ªåŠ¨å®šä½æ€§èƒ½ç“¶é¢ˆã€‚
è½åœ°åˆ‡å…¥ç‚¹ï¼šç»“åˆå¼€å‘æ•ˆç‡æå‡ç»éªŒï¼Œä¼˜å…ˆåœ¨ â€œè‡ªåŠ¨åŒ–å·¥å…·ç”Ÿæˆâ€ åœºæ™¯è½åœ°ï¼Œä¾‹å¦‚ï¼š
å¼€å‘ AI è¾…åŠ©çš„è¡¨å•é…ç½®å·¥å…·ï¼Œé€šè¿‡è‡ªç„¶è¯­è¨€æè¿°ï¼ˆå¦‚ â€œç”Ÿæˆä¸€ä¸ªåŒ…å«å§“åã€æ‰‹æœºå·çš„æ³¨å†Œè¡¨å•â€ï¼‰è‡ªåŠ¨ç”Ÿæˆ JSON Schemaï¼Œå†é€šè¿‡ç°æœ‰è½¬æ¢å·¥å…·ç”Ÿæˆè¡¨å•é¡¹ï¼Œå‡å°‘æ‰‹åŠ¨ç¼–å†™é…ç½®çš„å·¥ä½œé‡ã€‚

20ã€ä½ çš„é¡¹ç›®ä¸­ â€œjsonstring-pack å·¥å…·â€ å‹ç¼© JSON çš„é€»è¾‘æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœç”¨ AI æ¨¡å‹ä¼˜åŒ–å‹ç¼©ç®—æ³•ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿ

å‹ç¼©é€»è¾‘ï¼š
é€’å½’éå†å¤šå±‚åµŒå¥—çš„ JSONï¼Œè¯†åˆ«é‡å¤é”®åå’Œå€¼ï¼ˆå¦‚å¤šä¸ªå¯¹è±¡éƒ½æœ‰"status": "pending"ï¼‰ï¼›
å»ºç«‹æ˜ å°„è¡¨ï¼ˆå¦‚{ "status": 0, "pending": 1 }ï¼‰ï¼Œç”¨æ•°å­—æ›¿ä»£é‡å¤å­—ç¬¦ä¸²ï¼›
å»é™¤ç©ºæ ¼å’Œå†—ä½™å¼•å·ï¼Œå°† JSON è½¬æ¢ä¸ºç´§å‡‘æ ¼å¼ï¼ˆå¦‚{"a":1}â†’{a:1}ï¼‰ã€‚
æ•ˆæœï¼šæŸæ¬¡æµ‹è¯•ä¸­ 9MB JSON å‹ç¼©è‡³ 500KBã€‚
AI ä¼˜åŒ–æ€è·¯ï¼š
è®­ç»ƒåŸºäº Transformer çš„æ¨¡å‹ï¼Œå­¦ä¹  JSON ç»“æ„çš„è§„å¾‹ï¼ˆå¦‚é”®åçš„å‡ºç°é¢‘ç‡ã€åµŒå¥—å±‚æ¬¡ç‰¹å¾ï¼‰ï¼ŒåŠ¨æ€ç”Ÿæˆæ›´ä¼˜çš„å‹ç¼©æ˜ å°„è¡¨ï¼›å¯¹éç»“æ„åŒ–æ•°æ®ï¼ˆå¦‚é•¿æ–‡æœ¬æè¿°ï¼‰ï¼Œç”¨ AI è¿›è¡Œè¯­ä¹‰å‹ç¼©ï¼Œè¿›ä¸€æ­¥å‡å°‘ä½“ç§¯ã€‚

21ã€å¦‚ä½•çœ‹å¾… AI å¯¹å‰ç«¯å¼€å‘çš„å½±å“ï¼Ÿä½ è®¤ä¸ºå‰ç«¯å·¥ç¨‹å¸ˆéœ€è¦å…·å¤‡å“ªäº› AI ç›¸å…³æŠ€èƒ½ï¼Ÿ

å½±å“ï¼š
æ•ˆç‡æå‡ï¼šAI è¾…åŠ©ç”ŸæˆåŸºç¡€ä»£ç ï¼Œå‡å°‘é‡å¤åŠ³åŠ¨ï¼Œå‰ç«¯å·¥ç¨‹å¸ˆæ›´èšç„¦é€»è¾‘è®¾è®¡å’Œç”¨æˆ·ä½“éªŒï¼›
æŠ€æœ¯é—¨æ§›å˜åŒ–ï¼šç®€å•é¡µé¢å¼€å‘å¯èƒ½è¢«è‡ªåŠ¨åŒ–å·¥å…·æ›¿ä»£ï¼Œå¤æ‚äº¤äº’å’Œè·¨ç«¯ä¼˜åŒ–çš„éœ€æ±‚å¢å¼ºã€‚
æ‰€éœ€æŠ€èƒ½ï¼š
æç¤ºè¯å·¥ç¨‹ï¼šèƒ½æ¸…æ™°æè¿°éœ€æ±‚ï¼Œè®© AI ç”Ÿæˆæ›´ç²¾å‡†çš„ä»£ç ï¼›
æ¨¡å‹åŸºç¡€è®¤çŸ¥ï¼šäº†è§£ AI å·¥å…·çš„å±€é™æ€§ï¼ˆå¦‚é€»è¾‘é”™è¯¯ï¼‰ï¼Œèƒ½éªŒè¯å’Œä¿®æ­£ç”Ÿæˆç»“æœï¼›
è·¨é¢†åŸŸå­¦ä¹ ï¼šç»“åˆ AI ä¸å‰ç«¯å·¥ç¨‹åŒ–ï¼ˆå¦‚è‡ªåŠ¨åŒ–æµ‹è¯•ã€æ€§èƒ½ä¼˜åŒ–ï¼‰çš„èåˆåº”ç”¨ã€‚

22ã€åœ¨ â€œåè®®æ¨¡ç³Šæµ‹è¯•ç³»ç»Ÿâ€ ä¸­ï¼Œä½ ç”¨ protobuf åºåˆ—åŒ–æ•°æ®å‡å°‘ 70% ä¼ è¾“é‡ï¼Œå…·ä½“æ˜¯å¦‚ä½•è®¾è®¡æ•°æ®ç»“æ„çš„ï¼Ÿé‡åˆ°è¿‡å“ªäº›å…¼å®¹æ€§é—®é¢˜ï¼Ÿ

æ•°æ®ç»“æ„è®¾è®¡ï¼š
åœ¨åè®®æ¨¡ç³Šæµ‹è¯•ç³»ç»Ÿä¸­ï¼Œé’ˆå¯¹å›ºå®šç»“æ„çš„ ws æ¶ˆæ¯ï¼ˆå¦‚æµ‹è¯•ä»»åŠ¡çŠ¶æ€ï¼‰ï¼Œå®šä¹‰ protobuf schemaï¼š

```js
message TaskStatus {
  required string taskId = 1;
  required int32 progress = 2; // 0-100
  optional string error = 3; // é”™è¯¯ä¿¡æ¯ï¼Œå¯é€‰
}
```

å­—æ®µç”¨æ•°å­—æ ‡è¯†ï¼ˆ1ã€2ã€3ï¼‰å‡å°‘ä¼ è¾“é‡ï¼Œé€šè¿‡ required/optional æ§åˆ¶å¿…è¦æ€§ï¼Œå®ç°ç»“æ„åŒ–åºåˆ—åŒ–ã€‚
å…¼å®¹æ€§é—®é¢˜ï¼š
æ–°å¢å­—æ®µæ—¶ï¼Œè€ç‰ˆæœ¬è§£æå™¨å¯èƒ½å¿½ç•¥æ–°å¢å­—æ®µï¼Œå¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œè§£å†³æ–¹æ¡ˆï¼šæ ‡è®°æ–°å¢å­—æ®µä¸º optionalï¼›
å­—æ®µç±»å‹å˜æ›´ï¼ˆå¦‚ int32 æ”¹ä¸º stringï¼‰ä¼šå¯¼è‡´è§£æé”™è¯¯ï¼Œé€šè¿‡ç‰ˆæœ¬å·æ§åˆ¶ï¼ˆå¦‚åœ¨æ¶ˆæ¯å¤´åŠ å…¥ versionï¼‰ï¼Œä¸åŒç‰ˆæœ¬ç”¨ä¸åŒè§£æé€»è¾‘ã€‚

23ã€å½“ä½ æ¨åŠ¨ â€œå‰ç«¯å¼€å‘è§„èŒƒè®¾è®¡â€ï¼ˆå¼•å…¥ TypeScriptã€eslintï¼‰æ—¶ï¼Œå¦‚ä½•è¯´æœå›¢é˜Ÿæ¥å—ï¼Ÿï¼ˆä½“ç°æ²Ÿé€šä¸ç»„ç»‡èƒ½åŠ›ï¼‰

å…±è¯†å»ºç«‹ï¼šå…ˆç»„ç»‡å›¢é˜Ÿè®¨è®ºï¼Œç»“åˆé¡¹ç›®ç—›ç‚¹ï¼ˆå¦‚ç±»ç»„ä»¶ç»´æŠ¤å›°éš¾ã€ä»£ç é£æ ¼æ··ä¹±ï¼‰ï¼Œè¯´æ˜å¼•å…¥ TypeScript å’Œ ESLint çš„å¿…è¦æ€§ï¼›
æ¸è¿›å¼å®æ–½ï¼šä¸å¼ºåˆ¶ä¸€æ¬¡æ€§æ”¹é€ æ‰€æœ‰ä»£ç ï¼Œå…ˆä»æ–°åŠŸèƒ½å¼€å§‹ä½¿ç”¨å‡½æ•°ç»„ä»¶ + TypeScriptï¼Œå†é€æ­¥è¿ç§»æ—§ä»£ç ï¼›
å·¥å…·æ”¯æŒï¼šç¼–å†™è¿ç§»æŒ‡å—ï¼ˆå¦‚ç±»ç»„ä»¶è½¬å‡½æ•°ç»„ä»¶çš„æ­¥éª¤ï¼‰ï¼Œå¼€å‘è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆå¦‚æ‰¹é‡æ›¿æ¢ class ä¸ºå‡½æ•°ç»„ä»¶ï¼‰ï¼›
åˆ©ç›Šç»‘å®šï¼šå±•ç¤ºè§„èŒƒå¸¦æ¥çš„å®é™…æ”¶ç›Šï¼ˆå¦‚æµ‹è¯•é€šè¿‡ç‡æå‡ã€bug ç‡ä¸‹é™ï¼‰ï¼Œè®©å›¢é˜Ÿæ„Ÿå—åˆ°ä»·å€¼ã€‚

24ã€ä½ æœªæ¥æƒ³åœ¨è·¨ç«¯ã€AIã€å·¥ç¨‹åŒ–å“ªä¸ªæ–¹å‘æ·±å…¥ï¼Ÿå¦‚ä½•é€šè¿‡æŠ€æœ¯å¸¦åŠ¨å›¢é˜Ÿæˆé•¿ï¼Ÿï¼ˆåŒ¹é…å²—ä½ â€œæŠ€æœ¯è¿½æ±‚â€ è¦æ±‚ï¼‰

æ·±å…¥æ–¹å‘ï¼šä¼˜å…ˆèšç„¦è·¨ç«¯å¼€å‘ä¸å·¥ç¨‹åŒ–ï¼Œè¿™ä¸ç¾å›¢é…’æ—…ä¸šåŠ¡çš„å¤šç«¯é€‚é…éœ€æ±‚é«˜åº¦å¥‘åˆï¼Œä¸”èƒ½å¤ç”¨æˆ‘åœ¨ Electron å’Œ Webpack ä¼˜åŒ–ä¸­çš„ç»éªŒã€‚
å¸¦åŠ¨å›¢é˜Ÿæˆé•¿ï¼š
æŠ€æœ¯åˆ†äº«ï¼šå®šæœŸç»„ç»‡è·¨ç«¯é€‚é…ã€å·¥ç¨‹åŒ–å·¥å…·çš„å®æˆ˜åˆ†äº«ï¼Œç»“åˆé¡¹ç›®æ¡ˆä¾‹è®²è§£ï¼ˆå¦‚ Electron ä»£ç è¿ç§»ç»éªŒï¼‰ï¼›
å·¥å…·æ²‰æ·€ï¼šå°†é…ç½®å‹è¡¨å•ã€JSON å‹ç¼©ç­‰å·¥å…·æŠ½è±¡ä¸ºå›¢é˜Ÿé€šç”¨åº“ï¼Œé™ä½å¼€å‘é—¨æ§›ï¼›
è§„èŒƒè¿­ä»£ï¼šæ ¹æ®å›¢é˜Ÿåé¦ˆä¼˜åŒ–å¼€å‘è§„èŒƒï¼Œå»ºç«‹ â€œæå‡ºé—®é¢˜ â†’ è®¨è®ºæ–¹æ¡ˆ â†’ è½åœ°éªŒè¯â€ çš„è‰¯æ€§å¾ªç¯ï¼Œè®©æŠ€æœ¯è¿›æ­¥ä¼´éšä¸šåŠ¡æˆé•¿ã€‚

# 23 ç¾å›¢æ—…å±… 20250801 äºŒé¢

**é¢„æµ‹çš„é¢˜ç›®**

## ğŸ§© ä¸€ã€Webpack & å‰ç«¯å·¥ç¨‹åŒ–ï¼ˆ8 é¢˜ï¼‰

### 1. Webpack çš„æ¨¡å—æ‰“åŒ…æµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿè¯´è¯´ Loader å’Œ Plugin çš„æ‰§è¡Œæœºåˆ¶ã€‚

**æ‰“åŒ…æµç¨‹ï¼š**
1. **å…¥å£è§£æ**ï¼šä» entry é…ç½®å¼€å§‹ï¼Œè§£æå…¥å£æ–‡ä»¶
2. **ä¾èµ–æ”¶é›†**ï¼šé€’å½’è§£æ import/require è¯­å¥ï¼Œæ„å»ºä¾èµ–å›¾
3. **Loader å¤„ç†**ï¼šå¯¹æ¯ä¸ªæ¨¡å—åº”ç”¨é…ç½®çš„ loader
4. **Plugin å¤„ç†**ï¼šåœ¨æ„å»ºç”Ÿå‘½å‘¨æœŸå„é˜¶æ®µæ‰§è¡Œæ’ä»¶
5. **ä»£ç ç”Ÿæˆ**ï¼šç”Ÿæˆæœ€ç»ˆçš„ bundle æ–‡ä»¶

**Loader å’Œ Plugin æœºåˆ¶ï¼š**
```javascript
// webpack.config.js
module.exports = {
  module: {
    rules: [
      {
        test: /\.js$/,
        use: [
          'babel-loader', // è½¬æ¢ ES6+ è¯­æ³•
          'eslint-loader'  // ä»£ç æ£€æŸ¥
        ]
      }
    ]
  },
  plugins: [
    new HtmlWebpackPlugin(), // ç”Ÿæˆ HTML æ–‡ä»¶
    new MiniCssExtractPlugin() // æå– CSS
  ]
}
```

**æ‰§è¡Œé¡ºåºï¼š**
- Loaderï¼šä»å³åˆ°å·¦ï¼Œä»ä¸‹åˆ°ä¸Šæ‰§è¡Œ
- Pluginï¼šåœ¨ webpack æ„å»ºçš„ä¸åŒé˜¶æ®µè§¦å‘ï¼ˆå¦‚ beforeRunã€compileã€emit ç­‰ï¼‰

### 2. Webpack å¦‚ä½•åš Tree Shakingï¼Ÿå“ªç§æ¨¡å—è¯­æ³•æ”¯æŒï¼Ÿå®ƒçš„å±€é™åœ¨å“ªé‡Œï¼Ÿ

**Tree Shaking åŸç†ï¼š**
åŸºäº ES Module çš„é™æ€åˆ†æï¼Œç§»é™¤æœªä½¿ç”¨çš„ä»£ç ã€‚

```javascript
// æ”¯æŒ Tree Shaking çš„å†™æ³•
export const add = (a, b) => a + b;
export const subtract = (a, b) => a - b;

// ä½¿ç”¨æ–¹
import { add } from './math'; // åªæ‰“åŒ… add å‡½æ•°
```

**é…ç½®ç¤ºä¾‹ï¼š**
```javascript
// webpack.config.js
module.exports = {
  mode: 'production', // è‡ªåŠ¨å¯ç”¨ Tree Shaking
  optimization: {
    usedExports: true,
    sideEffects: false
  }
}
```

**package.json é…ç½®ï¼š**
```json
{
  "sideEffects": [
    "*.css",
    "*.scss"
  ]
}
```

**å±€é™æ€§ï¼š**
- åªæ”¯æŒ ES Module è¯­æ³•
- åŠ¨æ€å¯¼å…¥çš„æ¨¡å—æ— æ³•åˆ†æ
- æœ‰å‰¯ä½œç”¨çš„æ¨¡å—ä¼šè¢«ä¿ç•™
- ç¬¬ä¸‰æ–¹åº“å¯èƒ½ä¸æ”¯æŒ

### 3. å¦‚ä½•ä¼˜åŒ–å¤§å‹é¡¹ç›®çš„ Webpack æ„å»ºæ€§èƒ½ï¼Ÿ

**å¤šçº¿ç¨‹å¤„ç†ï¼š**
```javascript
module.exports = {
  module: {
    rules: [
      {
        test: /\.js$/,
        use: [
          {
            loader: 'thread-loader',
            options: {
              workers: 4
            }
          },
          'babel-loader'
        ]
      }
    ]
  }
}
```

**ç¼“å­˜ä¼˜åŒ–ï¼š**
```javascript
module.exports = {
  cache: {
    type: 'filesystem', // webpack5 æŒä¹…åŒ–ç¼“å­˜
    buildDependencies: {
      config: [__filename]
    }
  }
}
```

**å…¶ä»–ä¼˜åŒ–æªæ–½ï¼š**
- DllPluginï¼šå°†ç¬¬ä¸‰æ–¹åº“å•ç‹¬æ‰“åŒ…ï¼Œå‡å°‘ä¸»åŒ…æ„å»ºæ—¶é—´
- æŒä¹…åŒ–ç¼“å­˜ï¼ˆwebpack5ï¼‰ï¼šåˆ©ç”¨ filesystem cache
- æŒ‰éœ€åŠ è½½ï¼šè·¯ç”±æ‡’åŠ è½½ã€ç»„ä»¶æ‡’åŠ è½½
- å‡å°‘ loader æ•°é‡å’ŒèŒƒå›´ï¼ˆexclude node_modulesï¼‰
- ä½¿ç”¨ resolve.alias ç¼©çŸ­æŸ¥æ‰¾è·¯å¾„

### 4. å¦‚ä½•å®ç°å¤šé¡µé¢åº”ç”¨ï¼ˆMPAï¼‰çš„æ‰“åŒ…ï¼Ÿå’Œ SPA æœ‰ä½•ä¸åŒï¼Ÿ

**MPA æ‰“åŒ…é…ç½®ï¼š**
```javascript
module.exports = {
  entry: {
    index: './src/index.js',
    about: './src/about.js',
    contact: './src/contact.js'
  },
  plugins: [
    new HtmlWebpackPlugin({
      filename: 'index.html',
      template: './src/index.html',
      chunks: ['index']
    }),
    new HtmlWebpackPlugin({
      filename: 'about.html',
      template: './src/about.html',
      chunks: ['about']
    })
  ]
}
```

**ä¸ SPA åŒºåˆ«ï¼š**
- **SPA**ï¼šå•ä¸€å…¥å£å’Œ HTMLï¼Œå‰ç«¯è·¯ç”±æ§åˆ¶é¡µé¢åˆ‡æ¢
- **MPA**ï¼šå¤šä¸ªå…¥å£å’Œ HTMLï¼Œåç«¯è·¯ç”±æ§åˆ¶é¡µé¢åˆ‡æ¢
- **ä¼˜åŠ¿**ï¼šSEO å‹å¥½ï¼Œé¦–å±åŠ è½½å¿«ï¼Œé¡µé¢ç‹¬ç«‹
- **åŠ£åŠ¿**ï¼šé¡µé¢é—´åˆ‡æ¢ä¼šé‡æ–°åŠ è½½ï¼Œèµ„æºæ— æ³•å…±äº«

### 5. webpack5 çš„æŒä¹…åŒ–ç¼“å­˜æœºåˆ¶ï¼ˆPersistent Cachingï¼‰åŸç†ï¼Ÿ

**åŸç†è¯¦è§£ï¼š**
- webpack5 å¼•å…¥ filesystem cacheï¼Œå°†æ¨¡å—ç¼–è¯‘ç»“æœç¼“å­˜åˆ°ç£ç›˜
- é€šè¿‡æ–‡ä»¶å†…å®¹å“ˆå¸Œåˆ¤æ–­æ˜¯å¦éœ€è¦é‡æ–°ç¼–è¯‘
- ä¸‹æ¬¡æ„å»ºæ—¶ç›´æ¥è¯»å–ç¼“å­˜ï¼Œè·³è¿‡æœªå˜æ›´æ¨¡å—çš„ç¼–è¯‘

**é…ç½®ç¤ºä¾‹ï¼š**
```javascript
module.exports = {
  cache: {
    type: 'filesystem',
    version: '1.0', // ç¼“å­˜ç‰ˆæœ¬
    cacheDirectory: path.resolve(__dirname, '.webpack-cache'),
    buildDependencies: {
      config: [__filename], // é…ç½®æ–‡ä»¶å˜æ›´æ—¶å¤±æ•ˆç¼“å­˜
      tsconfig: [path.resolve(__dirname, 'tsconfig.json')]
    }
  }
}
```

**æ€§èƒ½æå‡ï¼š**
- é¦–æ¬¡æ„å»ºï¼šæ­£å¸¸é€Ÿåº¦
- äºŒæ¬¡æ„å»ºï¼šé€Ÿåº¦æå‡ 60-90%
- é€‚åˆå¤§å‹é¡¹ç›®ï¼Œæ˜¾è‘—æå‡å¼€å‘ä½“éªŒ

### 6. ä½ æ˜¯å¦‚ä½•è®¾è®¡ä¸€å¥—å‰ç«¯è„šæ‰‹æ¶çš„ï¼Ÿéœ€è¦æ³¨æ„å“ªäº›å¯é…ç½®é¡¹ï¼Ÿ

**è®¾è®¡æ¶æ„ï¼š**
```javascript
// cli.js
const inquirer = require('inquirer');
const fs = require('fs-extra');

async function createProject() {
  const answers = await inquirer.prompt([
    {
      type: 'list',
      name: 'framework',
      message: 'é€‰æ‹©æ¡†æ¶',
      choices: ['React', 'Vue', 'Angular']
    },
    {
      type: 'confirm',
      name: 'typescript',
      message: 'æ˜¯å¦ä½¿ç”¨ TypeScript?'
    }
  ]);
  
  // æ ¹æ®é€‰æ‹©ç”Ÿæˆé¡¹ç›®
  generateProject(answers);
}
```

**æ ¸å¿ƒå¯é…ç½®é¡¹ï¼š**
- **é¡¹ç›®ç±»å‹**ï¼šSPA/MPA/ç»„ä»¶åº“/Node.js
- **æŠ€æœ¯æ ˆ**ï¼šReact/Vue/Angular + TypeScript
- **æ„å»ºå·¥å…·**ï¼šWebpack/Vite/Rollup
- **ä»£ç è§„èŒƒ**ï¼šESLint/Prettier/Stylelint
- **æµ‹è¯•æ¡†æ¶**ï¼šJest/Vitest/Cypress
- **åŒ…ç®¡ç†å™¨**ï¼šnpm/yarn/pnpm
- **CI/CD**ï¼šGitHub Actions/GitLab CI
- **éƒ¨ç½²æ–¹æ¡ˆ**ï¼šVercel/Netlify/Docker

### 7. ä»‹ç»ä¸€ä¸‹ä½ é¡¹ç›®ä¸­ä½¿ç”¨çš„ CI/CD æµç¨‹ã€‚

**å®Œæ•´æµç¨‹ï¼š**
1. **ä»£ç æäº¤**ï¼špush/merge request è§¦å‘
2. **ä»£ç æ£€æŸ¥**ï¼šESLint/Prettier æ£€æŸ¥
3. **å•å…ƒæµ‹è¯•**ï¼šJest/Vitest æ‰§è¡Œæµ‹è¯•
4. **æ„å»ºæ‰“åŒ…**ï¼šWebpack/Vite æ„å»º
5. **éƒ¨ç½²å‘å¸ƒ**ï¼šè‡ªåŠ¨éƒ¨ç½²åˆ°æœåŠ¡å™¨

**GitHub Actions é…ç½®ï¼š**
```yaml
name: CI/CD Pipeline
on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Run linter
        run: npm run lint
      
      - name: Run tests
        run: npm test -- --coverage
      
      - name: Build project
        run: npm run build
      
      - name: Deploy to production
        if: github.ref == 'refs/heads/main'
        run: npm run deploy
        env:
          DEPLOY_TOKEN: ${{ secrets.DEPLOY_TOKEN }}
```

### 8. Monorepo ç®¡ç†æ–¹å¼æœ‰å“ªäº›ï¼Ÿä½ æ€ä¹ˆçœ‹å®ƒçš„ä¼˜åŠ¿ä¸åŠ£åŠ¿ï¼Ÿ

**ä¸»æµå·¥å…·å¯¹æ¯”ï¼š**

| å·¥å…· | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| Lerna | è€ç‰Œå·¥å…·ï¼Œå‘å¸ƒç®¡ç†å¼º | ä¼ ç»Ÿé¡¹ç›®è¿ç§» |
| pnpm workspace | æ€§èƒ½å¥½ï¼ŒèŠ‚çœç©ºé—´ | æ–°é¡¹ç›®æ¨è |
| Nx | æ™ºèƒ½æ„å»ºï¼Œç¼“å­˜ä¼˜åŒ– | å¤§å‹ä¼ä¸šé¡¹ç›® |
| Rush | å¾®è½¯å‡ºå“ï¼Œä¼ä¸šçº§ | è¶…å¤§è§„æ¨¡é¡¹ç›® |

**pnpm workspace é…ç½®ï¼š**
```json
// pnpm-workspace.yaml
packages:
  - 'packages/*'
  - 'apps/*'

// package.json
{
  "scripts": {
    "build": "pnpm -r run build",
    "test": "pnpm -r run test"
  }
}
```

**ä¼˜åŠ¿ï¼š**
- **ä¾èµ–ç»Ÿä¸€**ï¼šé¿å…ç‰ˆæœ¬å†²çªï¼Œå‡å°‘é‡å¤å®‰è£…
- **ä»£ç å¤ç”¨**ï¼šå…±äº«ç»„ä»¶åº“ã€å·¥å…·å‡½æ•°
- **åŸå­å‘å¸ƒ**ï¼šç›¸å…³åŒ…åŒæ­¥å‘å¸ƒï¼Œé¿å…ç‰ˆæœ¬ä¸ä¸€è‡´
- **å¼€å‘æ•ˆç‡**ï¼šç»Ÿä¸€æ„å»ºã€æµ‹è¯•ã€éƒ¨ç½²æµç¨‹
- **å›¢é˜Ÿåä½œ**ï¼šä»£ç å®¡æŸ¥ã€çŸ¥è¯†å…±äº«æ›´å®¹æ˜“

**åŠ£åŠ¿ï¼š**
- **å¤æ‚åº¦å¢åŠ **ï¼šä¾èµ–å…³ç³»å¤æ‚ï¼Œè°ƒè¯•å›°éš¾
- **æ„å»ºæ—¶é—´**ï¼šé¡¹ç›®å¤§æ—¶ï¼Œå…¨é‡æ„å»ºè€—æ—¶
- **æƒé™ç®¡ç†**ï¼šä¸åŒå›¢é˜Ÿå¯¹ä¸åŒåŒ…çš„æƒé™æ§åˆ¶
- **å­¦ä¹ æˆæœ¬**ï¼šå›¢é˜Ÿéœ€è¦é€‚åº”æ–°çš„å¼€å‘æ¨¡å¼

## âš›ï¸ äºŒã€React åŸç†ä¸åº”ç”¨ï¼ˆ8 é¢˜ï¼‰

### 9. React ä¸­å‡½æ•°ç»„ä»¶æ˜¯å¦‚ä½•å®ç°çŠ¶æ€ç®¡ç†çš„ï¼ŸuseState åº•å±‚åšäº†ä»€ä¹ˆï¼Ÿ

**Hook é“¾è¡¨åŸç†ï¼š**
React é€šè¿‡ Fiber èŠ‚ç‚¹ä¸Šçš„ memoizedState å±æ€§ç»´æŠ¤ Hook é“¾è¡¨ï¼Œæ¯ä¸ª Hook èŠ‚ç‚¹åŒ…å«ï¼š
- `memoizedState`ï¼šå½“å‰çŠ¶æ€å€¼
- `baseState`ï¼šåŸºç¡€çŠ¶æ€
- `queue`ï¼šæ›´æ–°é˜Ÿåˆ—
- `next`ï¼šæŒ‡å‘ä¸‹ä¸€ä¸ª Hook

**ç®€åŒ–å®ç°ï¼š**
```javascript
let currentFiber = null;
let hookIndex = 0;

function useState(initialState) {
  const currentHook = currentFiber.memoizedState?.[hookIndex] || {
    memoizedState: initialState,
    queue: []
  };
  
  // å¤„ç†æ›´æ–°é˜Ÿåˆ—
  currentHook.queue.forEach(update => {
    currentHook.memoizedState = update(currentHook.memoizedState);
  });
  currentHook.queue = [];
  
  const setState = (newState) => {
    const update = typeof newState === 'function' ? newState : () => newState;
    currentHook.queue.push(update);
    scheduleUpdate(); // è§¦å‘é‡æ–°æ¸²æŸ“
  };
  
  currentFiber.memoizedState[hookIndex] = currentHook;
  hookIndex++;
  
  return [currentHook.memoizedState, setState];
}
```

**å…³é”®æœºåˆ¶ï¼š**
- **é¡ºåºä¾èµ–**ï¼šHook å¿…é¡»æŒ‰ç›¸åŒé¡ºåºè°ƒç”¨
- **æ‰¹é‡æ›´æ–°**ï¼šå¤šä¸ª setState ä¼šåˆå¹¶ä¸ºä¸€æ¬¡æ›´æ–°
- **å‡½æ•°å¼æ›´æ–°**ï¼š`setState(prev => prev + 1)` é¿å…é—­åŒ…é™·é˜±

### 10. React çš„è°ƒå’Œï¼ˆReconciliationï¼‰æœºåˆ¶å…·ä½“åšäº†å“ªäº›ä¼˜åŒ–ï¼Ÿ

**Diff ç®—æ³•ä¼˜åŒ–ï¼š**

1. **æ ‘å±‚çº§æ¯”è¾ƒ**ï¼šåªæ¯”è¾ƒåŒå±‚èŠ‚ç‚¹ï¼Œæ—¶é—´å¤æ‚åº¦ O(n)
2. **ç»„ä»¶ç±»å‹åˆ¤æ–­**ï¼šä¸åŒç±»å‹ç›´æ¥æ›¿æ¢ï¼Œç›¸åŒç±»å‹é€’å½’æ¯”è¾ƒ
3. **Key åŒ¹é…æœºåˆ¶**ï¼šé€šè¿‡ key å¿«é€Ÿå®šä½å¯å¤ç”¨èŠ‚ç‚¹

**å…·ä½“å®ç°ï¼š**
```javascript
// ä¼ªä»£ç ï¼šDiff ç®—æ³•æ ¸å¿ƒé€»è¾‘
function reconcileChildren(currentFiber, newChildren) {
  let oldFiber = currentFiber.child;
  let newIdx = 0;
  
  // ç¬¬ä¸€è½®ï¼šå¤„ç†ç›¸åŒä½ç½®çš„èŠ‚ç‚¹
  while (oldFiber && newIdx < newChildren.length) {
    const newChild = newChildren[newIdx];
    
    if (oldFiber.key === newChild.key && oldFiber.type === newChild.type) {
      // å¯å¤ç”¨ï¼Œæ›´æ–° props
      const newFiber = createFiber(newChild, oldFiber);
      newFiber.alternate = oldFiber;
      newIdx++;
      oldFiber = oldFiber.sibling;
    } else {
      break; // ä½ç½®ä¸åŒ¹é…ï¼Œè¿›å…¥ç¬¬äºŒè½®
    }
  }
  
  // ç¬¬äºŒè½®ï¼šå¤„ç†ç§»åŠ¨ã€æ–°å¢ã€åˆ é™¤
  const existingChildren = mapRemainingChildren(oldFiber);
  
  while (newIdx < newChildren.length) {
    const newChild = newChildren[newIdx];
    const matchedFiber = existingChildren.get(newChild.key);
    
    if (matchedFiber) {
      // æ‰¾åˆ°åŒ¹é…èŠ‚ç‚¹ï¼Œæ ‡è®°ç§»åŠ¨
      existingChildren.delete(newChild.key);
    } else {
      // æ–°èŠ‚ç‚¹ï¼Œæ ‡è®°æ’å…¥
    }
    newIdx++;
  }
  
  // å‰©ä½™çš„æ—§èŠ‚ç‚¹æ ‡è®°åˆ é™¤
  existingChildren.forEach(child => {
    deleteChild(child);
  });
}
```

**æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ï¼š**
- **æœ€å° DOM æ“ä½œ**ï¼šåªæ›´æ–°å˜åŒ–çš„å±æ€§
- **æ‰¹é‡æ›´æ–°**ï¼šæ”¶é›†æ‰€æœ‰å˜æ›´ï¼Œä¸€æ¬¡æ€§åº”ç”¨
- **ä¼˜å…ˆçº§è°ƒåº¦**ï¼šé«˜ä¼˜å…ˆçº§æ›´æ–°å¯ä¸­æ–­ä½ä¼˜å…ˆçº§

### 11. ä»€ä¹ˆæ˜¯ React Fiberï¼Ÿå®ƒè§£å†³äº† React16 å‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ

**Fiber æ¶æ„ï¼š**
Fiber æ˜¯ä¸€ç§åŸºäºé“¾è¡¨çš„æ•°æ®ç»“æ„ï¼Œæ¯ä¸ª Fiber èŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªç»„ä»¶æˆ– DOM å…ƒç´ ã€‚

**Fiber èŠ‚ç‚¹ç»“æ„ï¼š**
```javascript
function FiberNode(tag, pendingProps, key, mode) {
  // èŠ‚ç‚¹ä¿¡æ¯
  this.tag = tag;                    // èŠ‚ç‚¹ç±»å‹
  this.key = key;                    // React key
  this.type = null;                  // ç»„ä»¶ç±»å‹
  
  // æ ‘ç»“æ„
  this.child = null;                 // ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹
  this.sibling = null;               // ä¸‹ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹
  this.return = null;                // çˆ¶èŠ‚ç‚¹
  
  // çŠ¶æ€
  this.memoizedState = null;         // å½“å‰çŠ¶æ€
  this.pendingProps = pendingProps;  // æ–°çš„ props
  this.memoizedProps = null;         // å½“å‰ props
  
  // è°ƒåº¦
  this.expirationTime = NoWork;      // è¿‡æœŸæ—¶é—´
  this.alternate = null;             // åŒç¼“å­˜
}
```

**è§£å†³çš„é—®é¢˜ï¼š**

1. **é•¿ä»»åŠ¡é˜»å¡**ï¼šReact15 é€’å½’æ›´æ–°ä¼šé˜»å¡ä¸»çº¿ç¨‹
2. **æ— æ³•ä¸­æ–­**ï¼šä¸€æ—¦å¼€å§‹æ›´æ–°å°±å¿…é¡»å®Œæˆ
3. **ä¼˜å…ˆçº§ç¼ºå¤±**ï¼šæ— æ³•åŒºåˆ†ç´§æ€¥å’Œéç´§æ€¥æ›´æ–°

**Fiber çš„ä¼˜åŠ¿ï¼š**
```javascript
// å¯ä¸­æ–­çš„æ¸²æŸ“è¿‡ç¨‹
function workLoop(deadline) {
  let shouldYield = false;
  
  while (nextUnitOfWork && !shouldYield) {
    nextUnitOfWork = performUnitOfWork(nextUnitOfWork);
    shouldYield = deadline.timeRemaining() < 1;
  }
  
  if (nextUnitOfWork) {
    // è¿˜æœ‰å·¥ä½œï¼Œä¸‹æ¬¡ç»§ç»­
    requestIdleCallback(workLoop);
  } else {
    // å·¥ä½œå®Œæˆï¼Œæäº¤æ›´æ–°
    commitRoot();
  }
}
```

### 12. React çš„æ‰¹å¤„ç†æ›´æ–°æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿåœ¨å“ªäº›æƒ…å†µä¸‹ä¼šå¤±æ•ˆï¼Ÿ

**æ‰¹å¤„ç†æœºåˆ¶ï¼š**
React é€šè¿‡ `isBatchingUpdates` æ ‡å¿—æ§åˆ¶æ˜¯å¦æ‰¹å¤„ç†æ›´æ–°ã€‚

**å·¥ä½œåŸç†ï¼š**
```javascript
// ç®€åŒ–çš„æ‰¹å¤„ç†é€»è¾‘
let isBatchingUpdates = false;
const updateQueue = [];

function setState(newState) {
  if (isBatchingUpdates) {
    updateQueue.push(newState);
  } else {
    // ç«‹å³æ›´æ–°
    performUpdate(newState);
  }
}

function batchedUpdates(fn) {
  const prevIsBatchingUpdates = isBatchingUpdates;
  isBatchingUpdates = true;
  
  try {
    fn();
  } finally {
    isBatchingUpdates = prevIsBatchingUpdates;
    if (!isBatchingUpdates && updateQueue.length > 0) {
      flushUpdates();
    }
  }
}
```

**æ‰¹å¤„ç†åœºæ™¯ï¼š**
```javascript
// âœ… ä¼šæ‰¹å¤„ç†
function handleClick() {
  setCount(count + 1);    // ä¸ä¼šç«‹å³é‡æ¸²æŸ“
  setValue(value + 1);    // ä¸ä¼šç«‹å³é‡æ¸²æŸ“
  // æ‰¹é‡æ‰§è¡Œï¼Œåªæ¸²æŸ“ä¸€æ¬¡
}

// âŒ ä¸ä¼šæ‰¹å¤„ç†ï¼ˆReact 17 åŠä¹‹å‰ï¼‰
function handleClick() {
  setTimeout(() => {
    setCount(count + 1);  // ç«‹å³é‡æ¸²æŸ“
    setValue(value + 1);  // ç«‹å³é‡æ¸²æŸ“
  }, 0);
}

// âœ… React 18 è‡ªåŠ¨æ‰¹å¤„ç†
function handleClick() {
  setTimeout(() => {
    setCount(count + 1);  // ä¼šæ‰¹å¤„ç†
    setValue(value + 1);  // ä¼šæ‰¹å¤„ç†
  }, 0);
}
```

**React 18 æ”¹è¿›ï¼š**
- é»˜è®¤å¯ç”¨è‡ªåŠ¨æ‰¹å¤„ç†
- ä½¿ç”¨ `flushSync` å¼ºåˆ¶åŒæ­¥æ›´æ–°

```javascript
import { flushSync } from 'react-dom';

flushSync(() => {
  setCount(count + 1);
});
// DOM å·²åŒæ­¥æ›´æ–°
```

### 13. useEffect å’Œ useLayoutEffect çš„æœ¬è´¨åŒºåˆ«ï¼Ÿä½ é‡åˆ°è¿‡ä»€ä¹ˆå®é™…é—®é¢˜ï¼Ÿ

**æ‰§è¡Œæ—¶æœºå¯¹æ¯”ï¼š**

```
æµè§ˆå™¨æ¸²æŸ“æµç¨‹ï¼š
DOM å˜æ›´ â†’ æ ·å¼è®¡ç®— â†’ å¸ƒå±€ â†’ ç»˜åˆ¶ â†’ åˆæˆ
         â†‘                    â†‘
   useLayoutEffect        useEffect
```

**å…·ä½“åŒºåˆ«ï¼š**
```javascript
function Component() {
  const [width, setWidth] = useState(0);
  
  // âŒ ä½¿ç”¨ useEffect ä¼šé—ªçƒ
  useEffect(() => {
    const element = document.getElementById('box');
    setWidth(element.offsetWidth);
  }, []);
  
  // âœ… ä½¿ç”¨ useLayoutEffect ä¸ä¼šé—ªçƒ
  useLayoutEffect(() => {
    const element = document.getElementById('box');
    setWidth(element.offsetWidth);
  }, []);
  
  return <div id="box" style={{ width: width > 100 ? '200px' : '50px' }} />;
}
```

**å®é™…é—®é¢˜æ¡ˆä¾‹ï¼š**

1. **DOM æµ‹é‡é—ªçƒ**ï¼š
```javascript
// é—®é¢˜ï¼šæµ‹é‡ DOM å°ºå¯¸æ—¶ä¼šé—ªçƒ
function Tooltip() {
  const [position, setPosition] = useState({ x: 0, y: 0 });
  
  useLayoutEffect(() => {
    // åŒæ­¥æµ‹é‡ï¼Œé¿å…é—ªçƒ
    const rect = tooltipRef.current.getBoundingClientRect();
    setPosition(calculatePosition(rect));
  });
}
```

2. **åŠ¨ç”»åˆå§‹åŒ–**ï¼š
```javascript
// éœ€è¦åœ¨ç»˜åˆ¶å‰è®¾ç½®åˆå§‹çŠ¶æ€
useLayoutEffect(() => {
  gsap.set(elementRef.current, { opacity: 0, y: 20 });
}, []);
```

**é€‰æ‹©åŸåˆ™ï¼š**
- éœ€è¦åŒæ­¥è¯»å–/ä¿®æ”¹ DOM â†’ `useLayoutEffect`
- å‰¯ä½œç”¨æ“ä½œï¼ˆè¯·æ±‚ã€è®¢é˜…ï¼‰â†’ `useEffect`

### 14. React ä¸­çš„ Context æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿä¸ºä»€ä¹ˆä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Ÿæ€ä¹ˆä¼˜åŒ–ï¼Ÿ

**Context å·¥ä½œåŸç†ï¼š**
```javascript
// Context åˆ›å»ºå’Œä½¿ç”¨
const ThemeContext = React.createContext();

function App() {
  const [theme, setTheme] = useState('light');
  
  // æ¯æ¬¡ theme å˜åŒ–ï¼Œæ‰€æœ‰æ¶ˆè´¹è€…éƒ½ä¼šé‡æ¸²æŸ“
  return (
    <ThemeContext.Provider value={{ theme, setTheme }}>
      <Header />
      <Main />
      <Footer />
    </ThemeContext.Provider>
  );
}

function Header() {
  const { theme } = useContext(ThemeContext);
  return <header className={theme}>Header</header>;
}
```

**æ€§èƒ½é—®é¢˜åŸå› ï¼š**
1. **å…¨é‡æ›´æ–°**ï¼šContext value å˜åŒ–æ—¶ï¼Œæ‰€æœ‰æ¶ˆè´¹è€…éƒ½é‡æ¸²æŸ“
2. **å¯¹è±¡å¼•ç”¨**ï¼šæ¯æ¬¡æ¸²æŸ“åˆ›å»ºæ–°å¯¹è±¡ï¼Œå¯¼è‡´ä¸å¿…è¦çš„æ›´æ–°
3. **æ·±å±‚ä¼ é€’**ï¼šä¸­é—´ç»„ä»¶ä¹Ÿä¼šé‡æ¸²æŸ“

**ä¼˜åŒ–ç­–ç•¥ï¼š**

1. **æ‹†åˆ† Context**ï¼š
```javascript
// å°†æ•°æ®å’Œæ“ä½œåˆ†ç¦»
const ThemeStateContext = React.createContext();
const ThemeDispatchContext = React.createContext();

function ThemeProvider({ children }) {
  const [theme, setTheme] = useState('light');
  
  return (
    <ThemeStateContext.Provider value={theme}>
      <ThemeDispatchContext.Provider value={setTheme}>
        {children}
      </ThemeDispatchContext.Provider>
    </ThemeStateContext.Provider>
  );
}
```

2. **ä½¿ç”¨ useMemo ç¼“å­˜ value**ï¼š
```javascript
function ThemeProvider({ children }) {
  const [theme, setTheme] = useState('light');
  
  const value = useMemo(() => ({
    theme,
    setTheme
  }), [theme]);
  
  return (
    <ThemeContext.Provider value={value}>
      {children}
    </ThemeContext.Provider>
  );
}
```

3. **ç»„ä»¶çº§ä¼˜åŒ–**ï¼š
```javascript
const Header = React.memo(function Header() {
  const { theme } = useContext(ThemeContext);
  return <header className={theme}>Header</header>;
});
```

### 15. å¦‚ä½•å®ç°ä¸€ä¸ªè‡ªå·±çš„ usePrevious Hookï¼Ÿ

**åŸºç¡€å®ç°ï¼š**
```javascript
import { useRef, useEffect } from 'react';

function usePrevious(value) {
  const ref = useRef();
  
  useEffect(() => {
    ref.current = value;
  }, [value]);
  
  return ref.current;
}

// ä½¿ç”¨ç¤ºä¾‹
function Counter() {
  const [count, setCount] = useState(0);
  const prevCount = usePrevious(count);
  
  return (
    <div>
      <p>å½“å‰å€¼: {count}</p>
      <p>ä¸Šä¸€æ¬¡å€¼: {prevCount}</p>
      <button onClick={() => setCount(count + 1)}>+1</button>
    </div>
  );
}
```

**å¢å¼ºç‰ˆæœ¬ï¼š**
```javascript
function usePrevious(value, initialValue) {
  const ref = useRef(initialValue);
  const prevRef = useRef();
  
  useEffect(() => {
    prevRef.current = ref.current;
    ref.current = value;
  });
  
  return prevRef.current;
}

// æ”¯æŒæ¯”è¾ƒå‡½æ•°çš„ç‰ˆæœ¬
function usePreviousDistinct(value, compare = Object.is) {
  const prevRef = useRef();
  const curRef = useRef();
  
  if (!compare(curRef.current, value)) {
    prevRef.current = curRef.current;
    curRef.current = value;
  }
  
  return prevRef.current;
}
```

**å®é™…åº”ç”¨åœºæ™¯ï¼š**
```javascript
// ç›‘å¬å˜åŒ–
function useChangeLogger(value, name) {
  const prevValue = usePrevious(value);
  
  useEffect(() => {
    if (prevValue !== undefined && prevValue !== value) {
      console.log(`${name} changed from ${prevValue} to ${value}`);
    }
  }, [value, prevValue, name]);
}

// åŠ¨ç”»è¿‡æ¸¡
function AnimatedCounter({ count }) {
  const prevCount = usePrevious(count);
  const isIncreasing = count > (prevCount ?? 0);
  
  return (
    <div className={isIncreasing ? 'increase' : 'decrease'}>
      {count}
    </div>
  );
}
```

### 16. React ä¸­å¦‚ä½•åšç»„ä»¶æ‡’åŠ è½½å’Œä»£ç åˆ†å‰²ï¼Ÿ

**åŸºç¡€æ‡’åŠ è½½ï¼š**
```javascript
import React, { Suspense } from 'react';

// åŠ¨æ€å¯¼å…¥ç»„ä»¶
const LazyComponent = React.lazy(() => import('./LazyComponent'));

function App() {
  return (
    <div>
      <Suspense fallback={<div>Loading...</div>}>
        <LazyComponent />
      </Suspense>
    </div>
  );
}
```

**è·¯ç”±çº§åˆ«åˆ†å‰²ï¼š**
```javascript
import { BrowserRouter, Routes, Route } from 'react-router-dom';

const Home = React.lazy(() => import('./pages/Home'));
const About = React.lazy(() => import('./pages/About'));
const Contact = React.lazy(() => import('./pages/Contact'));

function App() {
  return (
    <BrowserRouter>
      <Suspense fallback={<div>Loading page...</div>}>
        <Routes>
          <Route path="/" element={<Home />} />
          <Route path="/about" element={<About />} />
          <Route path="/contact" element={<Contact />} />
        </Routes>
      </Suspense>
    </BrowserRouter>
  );
}
```

**æ¡ä»¶æ‡’åŠ è½½ï¼š**
```javascript
function AdminPanel() {
  const [showAdmin, setShowAdmin] = useState(false);
  const [AdminComponent, setAdminComponent] = useState(null);
  
  const loadAdmin = async () => {
    const { default: Admin } = await import('./Admin');
    setAdminComponent(() => Admin);
    setShowAdmin(true);
  };
  
  return (
    <div>
      {!showAdmin && (
        <button onClick={loadAdmin}>
          Load Admin Panel
        </button>
      )}
      {showAdmin && AdminComponent && <AdminComponent />}
    </div>
  );
}
```

**é¢„åŠ è½½ä¼˜åŒ–ï¼š**
```javascript
// é¢„åŠ è½½ç»„ä»¶
const preloadComponent = (componentImport) => {
  const Component = React.lazy(componentImport);
  Component.preload = componentImport;
  return Component;
};

const LazyComponent = preloadComponent(() => import('./LazyComponent'));

// åœ¨ç”¨æˆ·å¯èƒ½éœ€è¦æ—¶é¢„åŠ è½½
function HomePage() {
  useEffect(() => {
    // é¼ æ ‡æ‚¬åœæ—¶é¢„åŠ è½½
    const link = document.querySelector('[data-preload="lazy"]');
    link?.addEventListener('mouseenter', LazyComponent.preload);
    
    return () => {
      link?.removeEventListener('mouseenter', LazyComponent.preload);
    };
  }, []);
}
```

**é”™è¯¯è¾¹ç•Œå¤„ç†ï¼š**
```javascript
class LazyErrorBoundary extends React.Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false };
  }
  
  static getDerivedStateFromError(error) {
    return { hasError: true };
  }
  
  componentDidCatch(error, errorInfo) {
    console.error('Lazy loading error:', error, errorInfo);
  }
  
  render() {
    if (this.state.hasError) {
      return <div>ç»„ä»¶åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>;
    }
    
    return this.props.children;
  }
}

// ä½¿ç”¨
<LazyErrorBoundary>
  <Suspense fallback={<Loading />}>
    <LazyComponent />
  </Suspense>
</LazyErrorBoundary>
```

## ğŸ› ï¸ ä¸‰ã€ç»¼åˆèƒ½åŠ› & å·¥ç¨‹å®è·µï¼ˆ4 é¢˜ï¼‰

### 17. å‰ç«¯åŸ‹ç‚¹ç³»ç»Ÿå¦‚ä½•è®¾è®¡ï¼Ÿå¦‚ä½•æ”¶é›†å¹¶ä¸ŠæŠ¥ç”¨æˆ·è¡Œä¸ºæ•°æ®ï¼Ÿ

**ç³»ç»Ÿæ¶æ„è®¾è®¡ï¼š**
```javascript
class Analytics {
  constructor(config) {
    this.config = config;
    this.queue = [];
    this.isOnline = navigator.onLine;
    this.init();
  }
  
  init() {
    this.autoTrack();
    this.listenNetworkStatus();
    this.startBatchReport();
  }
  
  // è‡ªåŠ¨åŸ‹ç‚¹
  autoTrack() {
    this.trackPageView();
    this.trackClicks();
    this.trackFormSubmits();
    this.trackErrors();
  }
  
  // é¡µé¢æµè§ˆåŸ‹ç‚¹
  trackPageView() {
    const data = {
      type: 'pageview',
      url: location.href,
      title: document.title,
      referrer: document.referrer,
      timestamp: Date.now(),
      userId: this.getUserId(),
      sessionId: this.getSessionId()
    };
    this.track(data);
  }
  
  // ç‚¹å‡»åŸ‹ç‚¹
  trackClicks() {
    document.addEventListener('click', (e) => {
      const target = e.target;
      const data = {
        type: 'click',
        element: target.tagName.toLowerCase(),
        text: target.textContent?.slice(0, 100),
        className: target.className,
        id: target.id,
        xpath: this.getXPath(target),
        timestamp: Date.now()
      };
      this.track(data);
    });
  }
  
  // æ‰¹é‡ä¸ŠæŠ¥
  async sendBatch() {
    if (this.queue.length === 0) return;
    
    const data = this.queue.splice(0, 10);
    
    try {
      if (navigator.sendBeacon) {
        navigator.sendBeacon(this.config.endpoint, JSON.stringify(data));
      } else {
        await fetch(this.config.endpoint, {
          method: 'POST',
          body: JSON.stringify(data),
          headers: { 'Content-Type': 'application/json' }
        });
      }
    } catch (error) {
      this.queue.unshift(...data);
      console.error('Analytics send failed:', error);
    }
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const analytics = new Analytics({
  endpoint: 'https://api.example.com/analytics',
  userId: 'user123'
});

analytics.track('button_click', {
  button_name: 'purchase',
  product_id: 'prod123',
  price: 99.99
});
```

**æ•°æ®æ”¶é›†ç­–ç•¥ï¼š**
1. **å…¨åŸ‹ç‚¹**ï¼šè‡ªåŠ¨æ”¶é›†æ‰€æœ‰ç”¨æˆ·è¡Œä¸º
2. **å¯è§†åŒ–åŸ‹ç‚¹**ï¼šé€šè¿‡ç•Œé¢é…ç½®åŸ‹ç‚¹
3. **ä»£ç åŸ‹ç‚¹**ï¼šæ‰‹åŠ¨æ·»åŠ åŸ‹ç‚¹ä»£ç 
4. **æ— åŸ‹ç‚¹**ï¼šé€šè¿‡ SDK è‡ªåŠ¨æ”¶é›†

### 18. å¦‚ä½•åœ¨é¡¹ç›®ä¸­åšæƒé™æ§åˆ¶ï¼Ÿå‰ç«¯æ€ä¹ˆä¿éšœè·¯ç”±ã€ç»„ä»¶çº§æƒé™ï¼Ÿ

**æƒé™ç³»ç»Ÿè®¾è®¡ï¼š**
```javascript
// æƒé™ç®¡ç† Hook
function useAuth() {
  const [user, setUser] = useState(null);
  const [permissions, setPermissions] = useState([]);
  const [roles, setRoles] = useState([]);
  
  const hasPermission = useCallback((permission) => {
    return permissions.includes(permission);
  }, [permissions]);
  
  const hasRole = useCallback((role) => {
    return roles.includes(role);
  }, [roles]);
  
  return {
    user,
    permissions,
    roles,
    hasPermission,
    hasRole,
    isAuthenticated: !!user
  };
}
```

**è·¯ç”±æƒé™æ§åˆ¶ï¼š**
```javascript
// è·¯ç”±å®ˆå«ç»„ä»¶
function ProtectedRoute({ children, requiredPermissions = [], requiredRoles = [] }) {
  const { isAuthenticated, hasPermission, hasRole } = useAuth();
  const navigate = useNavigate();
  
  useEffect(() => {
    if (!isAuthenticated) {
      navigate('/login');
      return;
    }
    
    // æ£€æŸ¥æƒé™
    const hasRequiredPermissions = requiredPermissions.every(hasPermission);
    const hasRequiredRoles = requiredRoles.length === 0 || requiredRoles.some(hasRole);
    
    if (!hasRequiredPermissions || !hasRequiredRoles) {
      navigate('/403');
    }
  }, [isAuthenticated, requiredPermissions, requiredRoles]);
  
  return children;
}

// è·¯ç”±é…ç½®
function App() {
  return (
    <Routes>
      <Route path="/login" element={<Login />} />
      <Route path="/403" element={<Forbidden />} />
      
      <Route path="/admin" element={
        <ProtectedRoute requiredRoles={['admin']}>
          <AdminPanel />
        </ProtectedRoute>
      } />
      
      <Route path="/users" element={
        <ProtectedRoute requiredPermissions={['user:read']}>
          <UserList />
        </ProtectedRoute>
      } />
    </Routes>
  );
}
```

**ç»„ä»¶çº§æƒé™æ§åˆ¶ï¼š**
```javascript
// æƒé™åŒ…è£…ç»„ä»¶
function PermissionWrapper({ 
  children, 
  permissions = [], 
  roles = [], 
  fallback = null
}) {
  const { hasPermission, hasRole } = useAuth();
  
  const hasRequiredPermissions = permissions.length === 0 || permissions.some(hasPermission);
  const hasRequiredRoles = roles.length === 0 || roles.some(hasRole);
  
  const hasAccess = hasRequiredPermissions && hasRequiredRoles;
  
  return hasAccess ? children : fallback;
}

// ä½¿ç”¨ç¤ºä¾‹
function UserManagement() {
  return (
    <div>
      <h1>ç”¨æˆ·ç®¡ç†</h1>
      
      <PermissionWrapper permissions={['user:create']}>
        <button>æ·»åŠ ç”¨æˆ·</button>
      </PermissionWrapper>
      
      <PermissionWrapper roles={['admin', 'super_admin']}>
        <button>åˆ é™¤ç”¨æˆ·</button>
      </PermissionWrapper>
    </div>
  );
}
```

### 19. å¼€å‘ä¸­å¦‚ä½•å®šä½å’Œä¼˜åŒ–å‰ç«¯æ€§èƒ½ç“¶é¢ˆï¼Ÿ

**æ€§èƒ½ç›‘æ§ä½“ç³»ï¼š**
```javascript
// æ€§èƒ½ç›‘æ§ç±»
class PerformanceMonitor {
  constructor() {
    this.metrics = {};
    this.init();
  }
  
  init() {
    this.observeWebVitals();
    this.observeLongTasks();
    this.observeMemoryUsage();
  }
  
  // ç›‘æ§ Web Vitals
  observeWebVitals() {
    // First Contentful Paint
    new PerformanceObserver((list) => {
      const entries = list.getEntries();
      entries.forEach(entry => {
        if (entry.name === 'first-contentful-paint') {
          this.report('fcp', entry.startTime);
        }
      });
    }).observe({ entryTypes: ['paint'] });
    
    // Largest Contentful Paint
    new PerformanceObserver((list) => {
      const entries = list.getEntries();
      const lastEntry = entries[entries.length - 1];
      this.report('lcp', lastEntry.startTime);
    }).observe({ entryTypes: ['largest-contentful-paint'] });
  }
  
  // é•¿ä»»åŠ¡ç›‘æ§
  observeLongTasks() {
    new PerformanceObserver((list) => {
      list.getEntries().forEach(entry => {
        this.report('long-task', {
          duration: entry.duration,
          startTime: entry.startTime
        });
      });
    }).observe({ entryTypes: ['longtask'] });
  }
  
  report(metric, value) {
    console.log(`Performance metric: ${metric}`, value);
  }
}
```

**æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ï¼š**
```javascript
// å›¾ç‰‡æ‡’åŠ è½½
function LazyImage({ src, alt, ...props }) {
  const [imageSrc, setImageSrc] = useState('');
  const imgRef = useRef();
  
  useEffect(() => {
    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          setImageSrc(src);
          observer.disconnect();
        }
      },
      { threshold: 0.1 }
    );
    
    if (imgRef.current) {
      observer.observe(imgRef.current);
    }
    
    return () => observer.disconnect();
  }, [src]);
  
  return <img ref={imgRef} src={imageSrc} alt={alt} {...props} />;
}

// è™šæ‹Ÿæ»šåŠ¨
function VirtualList({ items, itemHeight, containerHeight }) {
  const [scrollTop, setScrollTop] = useState(0);
  
  const visibleCount = Math.ceil(containerHeight / itemHeight);
  const startIndex = Math.floor(scrollTop / itemHeight);
  const endIndex = Math.min(startIndex + visibleCount, items.length);
  
  const visibleItems = items.slice(startIndex, endIndex);
  
  return (
    <div
      style={{ height: containerHeight, overflow: 'auto' }}
      onScroll={(e) => setScrollTop(e.target.scrollTop)}
    >
      <div style={{ height: items.length * itemHeight, position: 'relative' }}>
        {visibleItems.map((item, index) => (
          <div
            key={startIndex + index}
            style={{
              position: 'absolute',
              top: (startIndex + index) * itemHeight,
              height: itemHeight,
              width: '100%'
            }}
          >
            {item}
          </div>
        ))}
      </div>
    </div>
  );
}
```

### 20. è¯´è¯´ä½ åœ¨é¡¹ç›®ä¸­é‡åˆ°è¿‡çš„ä¸€æ¬¡æŠ€æœ¯éš¾é¢˜ï¼Œä»¥åŠä½ çš„è§£å†³è¿‡ç¨‹ã€‚

**æ¡ˆä¾‹ï¼šå¤§å‹è¡¨æ ¼æ€§èƒ½ä¼˜åŒ–**

**é—®é¢˜èƒŒæ™¯ï¼š**
åœ¨ä¸€ä¸ªæ•°æ®ç®¡ç†å¹³å°ä¸­ï¼Œéœ€è¦å±•ç¤ºåŒ…å« 10 ä¸‡+ è¡Œæ•°æ®çš„è¡¨æ ¼ï¼Œæ¯è¡ŒåŒ…å« 20+ åˆ—ã€‚åˆå§‹å®ç°å¯¼è‡´é¡µé¢å¡é¡¿ä¸¥é‡ï¼Œæ»šåŠ¨ä¸æµç•…ï¼Œå†…å­˜å ç”¨è¿‡é«˜ã€‚

**é—®é¢˜åˆ†æï¼š**
1. **DOM èŠ‚ç‚¹è¿‡å¤š**ï¼š10ä¸‡è¡Œ Ã— 20åˆ— = 200ä¸‡ä¸ª DOM èŠ‚ç‚¹
2. **å†…å­˜å ç”¨**ï¼šæ‰€æœ‰æ•°æ®åŒæ—¶æ¸²æŸ“ï¼Œå†…å­˜å ç”¨è¶…è¿‡ 500MB
3. **æ¸²æŸ“é˜»å¡**ï¼šå¤§é‡ DOM æ“ä½œé˜»å¡ä¸»çº¿ç¨‹
4. **äº‹ä»¶ç›‘å¬**ï¼šæ¯ä¸ªå•å…ƒæ ¼éƒ½æœ‰ç‚¹å‡»äº‹ä»¶ï¼Œäº‹ä»¶ç›‘å¬å™¨è¿‡å¤š

**è§£å†³æ–¹æ¡ˆï¼š**

1. **å®ç°è™šæ‹Ÿæ»šåŠ¨ï¼š**
```javascript
function VirtualTable({ data, columns, rowHeight = 40 }) {
  const [scrollTop, setScrollTop] = useState(0);
  const [containerHeight, setContainerHeight] = useState(600);
  
  // è®¡ç®—å¯è§è¡ŒèŒƒå›´
  const startIndex = Math.floor(scrollTop / rowHeight);
  const visibleCount = Math.ceil(containerHeight / rowHeight) + 2;
  const endIndex = Math.min(startIndex + visibleCount, data.length);
  
  // åªæ¸²æŸ“å¯è§è¡Œ
  const visibleData = data.slice(startIndex, endIndex);
  
  const handleScroll = useCallback(
    throttle((e) => {
      setScrollTop(e.target.scrollTop);
    }, 16), // 60fps
    []
  );
  
  return (
    <div
      style={{ height: containerHeight, overflow: 'auto' }}
      onScroll={handleScroll}
    >
      <div style={{ height: data.length * rowHeight }}>
        <div
          style={{
            transform: `translateY(${startIndex * rowHeight}px)`,
            position: 'absolute',
            width: '100%'
          }}
        >
          {visibleData.map((row, index) => (
            <TableRow
              key={startIndex + index}
              data={row}
              columns={columns}
              height={rowHeight}
            />
          ))}
        </div>
      </div>
    </div>
  );
}
```

2. **äº‹ä»¶å§”æ‰˜ä¼˜åŒ–ï¼š**
```javascript
function VirtualTable({ data, onCellClick }) {
  const handleTableClick = useCallback((e) => {
    const cell = e.target.closest('.table-cell');
    if (cell) {
      const rowIndex = parseInt(cell.dataset.rowIndex);
      const colIndex = parseInt(cell.dataset.colIndex);
      onCellClick?.(rowIndex, colIndex, data[rowIndex]);
    }
  }, [data, onCellClick]);
  
  return (
    <div onClick={handleTableClick}>
      {/* è¡¨æ ¼å†…å®¹ */}
    </div>
  );
}
```

**æœ€ç»ˆæ•ˆæœï¼š**
- **å†…å­˜å ç”¨**ï¼šä» 500MB+ é™è‡³ 50MB ä»¥å†…
- **æ¸²æŸ“æ€§èƒ½**ï¼š60fps æµç•…æ»šåŠ¨
- **é¦–å±æ—¶é—´**ï¼šä» 3s+ é™è‡³ 300ms
- **äº¤äº’å“åº”**ï¼šç‚¹å‡»å“åº”æ—¶é—´ < 100ms

**ç»éªŒæ€»ç»“ï¼š**
1. **è™šæ‹ŸåŒ–æ˜¯å…³é”®**ï¼šåªæ¸²æŸ“å¯è§åŒºåŸŸ
2. **äº‹ä»¶å§”æ‰˜**ï¼šå‡å°‘äº‹ä»¶ç›‘å¬å™¨æ•°é‡
3. **ç¼“å­˜ç­–ç•¥**ï¼šåˆç†çš„æ•°æ®ç¼“å­˜æœºåˆ¶
4. **æ€§èƒ½ç›‘æ§**ï¼šå®æ—¶ç›‘æ§æ€§èƒ½æŒ‡æ ‡
5. **æ¸è¿›ä¼˜åŒ–**ï¼šå…ˆè§£å†³æœ€å¤§ç“¶é¢ˆï¼Œå†ä¼˜åŒ–ç»†èŠ‚
